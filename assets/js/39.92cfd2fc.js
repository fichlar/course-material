(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{440:function(t,e,s){"use strict";s.r(e);var a=s(40),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"project-instructions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#project-instructions"}},[t._v("#")]),t._v(" Project Instructions")]),t._v(" "),s("p",[t._v("As project you should work in pairs and create a platform (a solution consisting of both a backend application handling the data on the platform and a frontend application containing the graphical user interface through which users will use the platform). The backend should expose a REST API which the frontend can use to work with the data on the platform. The platform should be implemented with the technologies taught in the course, i.e. Node.js/Express for the backend and Vue.js for the frontend.")]),t._v(" "),s("p",[t._v("You should not only implement the platform, you should also write a report describing the platform and its implementation, including what it can be used for and how it has been implemented. The file "),s("a",{attrs:{href:"static-files/project-report-template.docx"}},[t._v("project-report-template.docx")]),t._v(" contains a template for the report. Your report will be a living document throughout the course, meaning that you will write on it from the start and continually improve it until the end of the course.")]),t._v(" "),s("h2",{attrs:{id:"part-1-find-a-partner"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-1-find-a-partner"}},[t._v("#")]),t._v(" Part 1: Find a partner")]),t._v(" "),s("p",[t._v("Start by finding a classmate to work with. Then "),s("a",{attrs:{href:"https://pingpong.hj.se/courseId/21410/projectGroupsList.do#&tab=allGroups",target:"_blank",rel:"noopener noreferrer"}},[t._v("join a project group on Ping Pong"),s("OutboundLink")],1),t._v(" to let the examiner know who you're working with. If you can't find a classmate to work with, email the course coordinator at "),s("a",{attrs:{href:"mailto:Peter.Larsson-Green@ju.se"}},[t._v("Peter.Larsson-Green@ju.se")]),t._v(" and he will pair you with another student in the same situation.")]),t._v(" "),s("h2",{attrs:{id:"part-2-platform-idea"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-2-platform-idea"}},[t._v("#")]),t._v(" Part 2: Platform idea")]),t._v(" "),s("p",[t._v("Come up with the platform you want to implement. The platform may be about whatever you want, but the following requirements exist:")]),t._v(" "),s("ul",[s("li",[t._v("Users should be able to create accounts.")]),t._v(" "),s("li",[t._v("Users should be able to login to accounts.")]),t._v(" "),s("li",[t._v("Users should be able to create at least one other type of resource (in addition to accounts) that belongs to an account.")])]),t._v(" "),s("p",[t._v("Example of the additional resource type could be:")]),t._v(" "),s("ul",[s("li",[t._v("Blogposts for a platform hosting blogs.")]),t._v(" "),s("li",[t._v("Diary entries for platforms hosting diaries.")]),t._v(" "),s("li",[t._v("Movies for a platform where users can register movies they've watched.")])]),t._v(" "),s("p",[t._v("If you want to have a more fun platform to implement, you probably need to have accounts + 2-3 additional resource types, but it is OK to just have one additional resource type.")]),t._v(" "),s("p",[t._v("Try to be creative and come up with an idea that solves a real world problem. For example, "),s("em",[t._v("standing in line and wait")]),t._v(" is boring, maybe you can come up with a platform that somehow makes it fun? Or maybe a platform that entirely eliminates the need to stand in line and wait? Or maybe you know someone (football coach, friend at a company, etc.) that have some problem you can help them with by creating a platform (such as keeping track of which players attended which practice sessions, or who's responsible to bring fika to work each friday, etc.).")]),t._v(" "),s("p",[t._v("Users should be able to apply "),s("abbr",{attrs:{title:"Create, Read, Update, Delete"}},[t._v("CRUD")]),t._v(" operations on at least accounts + 1 additional resource type on the platform, but how they do that through the frontend is up to you to decide. For example, to delete an account you may have a delete button either on the "),s("em",[t._v("View account")]),t._v(' "page" or you may have a dedicated '),s("em",[t._v("Delete account")]),t._v(' "page" that only contains the delete button. Users should also be able to login to the account they have created using a username and a password.')]),t._v(" "),s("p",[t._v("Describe your platform as detailed as possible in your project report. To a large extent you should be able to finish the chapters "),s("em",[t._v("Introduction")]),t._v(", "),s("em",[t._v("Database")]),t._v(" and "),s("em",[t._v("Frontend Application")]),t._v(" (describe the GUI, not implementation details for now).")]),t._v(" "),s("h2",{attrs:{id:"part-3-designing-the-rest-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-3-designing-the-rest-api"}},[t._v("#")]),t._v(" Part 3: Designing the REST API")]),t._v(" "),s("p",[t._v("Before you start working on this part you are expected to view the following lectures:")]),t._v(" "),s("ul",[s("li",[s("RouterLink",{attrs:{to:"/lectures/internet-basics/"}},[t._v("Internet Basics")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/http-and-web-applications/"}},[t._v("HTTP and Web Applications")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/rest-api-basics/"}},[t._v("REST API Basics")])],1)]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v('Design the REST API you will implement on the backend and through which the frontend will communicate with it. By looking at the graphical user interface in your report you should be able to figure out which type of requests the frontend needs to be able to send to the backend to be able to function properly. For example, if the frontend  have a "page" showing a list of all accounts, then your REST API should send back all accounts when it receives a '),s("code",[t._v("GET")]),t._v(" request for "),s("code",[t._v("/accounts")]),t._v(' (or similar), and if the frontend have a "page" showing all information about an account with a specific id, then your REST API should send back all information about an account with a '),s("code",[t._v("SPECIFIC_ID")]),t._v(" when it receives a "),s("code",[t._v("GET")]),t._v(" request for "),s("code",[t._v("/accounts/SPECIFIC_ID")]),t._v(" (or similar).")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),s("p",[t._v("You do not need to worry about login functionality (authentication and authorization) yet, that comes in Part 6.")])]),t._v(" "),s("p",[t._v("Describe the REST API in your project report. Be as detailed as possible. Other programmers should understand how to use your REST API just by reading the specification for it in your report. This means that you must mention details such as which methods, URI:s, status codes, headers etc. that are used in your REST API for each type of request it can handle.")]),t._v(" "),s("h2",{attrs:{id:"part-4-implementing-the-rest-api-in-express"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-4-implementing-the-rest-api-in-express"}},[t._v("#")]),t._v(" Part 4: Implementing the REST API in Express")]),t._v(" "),s("p",[t._v("Before you start working on this part you are expected to view the following lectures:")]),t._v(" "),s("ul",[s("li",[s("RouterLink",{attrs:{to:"/lectures/node-js/"}},[t._v("Node.js")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/web-applications-in-node-js/"}},[t._v("Web Applications in Node.js")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/npm/"}},[t._v("npm")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/express-basics/"}},[t._v("Express Basics")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/rest-api-in-express/"}},[t._v("REST API in Express")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/sqlite/"}},[t._v("SQLite")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/using-sqlite-in-node-js/"}},[t._v("Using SQLite in Node.js")])],1)]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("Implement the REST API you've specified in your project report so far as an Express application that stores the resources in an SQLite database. Next you'll find some guiding steps to help you get started.")]),t._v(" "),s("h3",{attrs:{id:"getting-started-with-express"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-started-with-express"}},[t._v("#")]),t._v(" Getting started with Express")]),t._v(" "),s("p",[t._v("Start by creating a new folder to store the source code for your backend application:")]),t._v(" "),s("ol",[s("li",[t._v("Open a terminal/shell/console, for example "),s("em",[t._v("Windows PowerShell")]),t._v(" in Windows.")]),t._v(" "),s("li",[t._v("Navigate to the folder where you want to create the root folder of your source code. Use the following commands:\n"),s("ul",[s("li",[s("code",[t._v("cd /projects")]),t._v(" - Go into the sub-folder named "),s("code",[t._v("projects")])]),t._v(" "),s("li",[s("code",[t._v("cd ../")]),t._v("- Go back to the parent folder (you probably will not need to use this one)")])])]),t._v(" "),s("li",[t._v("Create the root folder for your project's source code files by running the following command:\n"),s("ul",[s("li",[s("code",[t._v("mkdir my-backend")]),t._v(" - Create a new folder named "),s("code",[t._v("my-backend")]),t._v(" (use a better name)")])])]),t._v(" "),s("li",[t._v("Go into the root folder by running the following command:\n"),s("ul",[s("li",[s("code",[t._v("cd my-backend")]),t._v(" - Go into the sub-folder named "),s("code",[t._v("my-backend")])])])]),t._v(" "),s("li",[t._v("Create the "),s("code",[t._v("package.json")]),t._v(" file (which keep tracks of which npm packages the project is using) by running the following command:\n"),s("ul",[s("li",[s("code",[t._v("npm init --yes")]),t._v(" - Creates the "),s("code",[t._v("package.json")]),t._v("file.")])])]),t._v(" "),s("li",[t._v("Install the "),s("code",[t._v("express")]),t._v(" package by running the following command:\n"),s("ul",[s("li",[s("code",[t._v("npm install express")]),t._v(" - Installs the "),s("code",[t._v("express")]),t._v(" package for this project")])])])]),t._v(" "),s("p",[t._v("Then open the root folder of your project in your code editor:")]),t._v(" "),s("ol",{attrs:{start:"7"}},[s("li",[t._v("Use the following command to open the root folder in Visual Studio Code:\n"),s("ul",[s("li",[s("code",[t._v("code .")]),t._v(" - Open the root folder in Visual Studio Code.\n"),s("strong",[t._v("Note")]),t._v(": "),s("a",{attrs:{href:"https://code.visualstudio.com/docs/setup/mac#_launching-from-the-command-line",target:"_blank",rel:"noopener noreferrer"}},[t._v("On Mac you need to add the code command"),s("OutboundLink")],1),t._v(".")])])])]),t._v(" "),s("p",[t._v("Then create the file "),s("code",[t._v("app.js")]),t._v(" with the content shown below. That code is a web application sending back the text "),s("code",[t._v("Hello, World")]),t._v(" when you visit "),s("a",{attrs:{href:"http://localhost:3000/",target:"_blank",rel:"noopener noreferrer"}},[t._v("localhost:3000/"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello, World"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("Test if everything works by running your application and then visit "),s("a",{attrs:{href:"http://localhost:3000/",target:"_blank",rel:"noopener noreferrer"}},[t._v("localhost:3000/"),s("OutboundLink")],1),t._v(" a web browser or using Postman to send a GET request for the URI "),s("code",[t._v("http://localhost:3000/")]),t._v(". You can run your application either through the Debug section in Visual Studio Code or through the "),s("code",[t._v("node")]),t._v(" command in your terminal/shell/console:")]),t._v(" "),s("ol",{attrs:{start:"8"}},[s("li",[t._v("Run your web application using the following command:\n"),s("ul",[s("li",[s("code",[t._v("node app.js")]),t._v(" â€“ Use Node.js to execute the code in the file "),s("code",[t._v("app.js")])])])])]),t._v(" "),s("p",[t._v("If everything works, you should see the text "),s("code",[t._v("Hello, World")]),t._v(" in your web browser.")]),t._v(" "),s("p",[t._v("If you started the web application through a terminal/shell/console, you can stop it from running by holding "),s("kbd",[t._v("CTRL")]),t._v(" and pressing "),s("kbd",[t._v("C")]),t._v(" (possibly twice) in the terminal/shell/console that started it. You can then change the code in "),s("code",[t._v("app.js")]),t._v(", and then run the node command to start your web application again.")]),t._v(" "),s("p",[t._v("Play around a little bit to learn the basics:")]),t._v(" "),s("ul",[s("li",[t._v("Can you change the text that is sent back to the client?")]),t._v(" "),s("li",[t._v("Can you add a function handling GET requests for another URI and that sends back another text to the client?")]),t._v(" "),s("li",[t._v("What happens when a client sends a GET request for a URI that does not exist?")])]),t._v(" "),s("h3",{attrs:{id:"getting-started-with-sqlite"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-started-with-sqlite"}},[t._v("#")]),t._v(" Getting started with SQLite")]),t._v(" "),s("p",[t._v("The resources on the platform should be stored in a database. In this course we will use the relational database SQLite as our database. SQLite is most often not the best choice for big platforms with a lot of users, but it is easy to use and to get started with, and you can later replace it with a more powerful database when needed.")]),t._v(" "),s("p",[t._v("SQLite stores the entire database in a single file and does not require any installation in addition to an npm package exposing an API you can use to communicate with it.")]),t._v(" "),s("p",[t._v("Start by installing the "),s("code",[t._v("sqlite3")]),t._v(" package (feel free to use "),s("code",[t._v("sqlite")]),t._v(" instead if you want to use promises (and optionally "),s("code",[t._v("async")]),t._v("/"),s("code",[t._v("await")]),t._v(") to avoid "),s("a",{attrs:{href:"http://callbackhell.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("callback hell"),s("OutboundLink")],1),t._v(", although that's not something you will learn in this course):")]),t._v(" "),s("ol",[s("li",[t._v("Open a terminal/shell/console and navigate to your project folder.")]),t._v(" "),s("li",[t._v("Install the npm package "),s("code",[t._v("sqlite3")]),t._v(" by running the following command:\n"),s("ul",[s("li",[s("code",[t._v("npm install sqlite3")]),t._v(" - Installs the npm package "),s("code",[t._v("sqlite3")])])])])]),t._v(" "),s("p",[t._v("Then use "),s("code",[t._v("sqlite3")]),t._v(" in your backend to create a new database to store your resources in. Here are some guiding steps helping you with the accounts resources:")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("Add the line "),s("code",[t._v("const sqlite3 = require('sqlite3')")]),t._v(".")]),t._v(" "),s("li",[t._v("Add the line "),s("code",[t._v('const db = new sqlite3.Database("my-database.db")')]),t._v(".")]),t._v(" "),s("li",[t._v("Use "),s("code",[t._v('db.run("Your SQL query")')]),t._v("to send a query to the database creating a table that can be used to store the accounts on the platform.")]),t._v(" "),s("li",[t._v("Start the backend again. When you do this, the web application will send the query above to the database, which in turn will create the table to store the accounts in.")]),t._v(" "),s("li",[t._v("Open your database file in DB Browser for SQLite and verify that the table has been created.")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),s("p",[t._v("If you send a query like "),s("code",[t._v("CREATE TABLE accounts (...)")]),t._v("to the database, you will get an error the second time you start your backend, because the table "),s("code",[t._v("accounts")]),t._v(" already exists in the database. Instead, you can send a query like "),s("code",[t._v("CREATE TABLE IF NOT EXISTS accounts (...)")]),t._v(", which will attempt to create the "),s("code",[t._v("accounts")]),t._v(" table only if it does not already exist.")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),s("p",[t._v("In the end the passwords should not be stored in plain text in the database, only their hash values, but to give you a gentle start we will not care about hashing them now.")])]),t._v(" "),s("p",[t._v("Use DB Browser for SQLite to manually insert some accounts (remember to click on the "),s("code",[t._v("Write Changes")]),t._v(" button in the GUI!). Then let's write the code letting clients fetch accounts (this might not be in line with what you've written in your report, so you might need to modify the code below a little bit).")]),t._v(" "),s("h3",{attrs:{id:"fetching-all-accounts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fetching-all-accounts"}},[t._v("#")]),t._v(" Fetching all accounts")]),t._v(" "),s("p",[t._v("To let clients fetch all accounts, they can send a GET request to "),s("code",[t._v("/accounts")]),t._v(". When the backend receives this request, it needs to fetch all accounts from the database and send them back in JSON format. To make that happen, you can use the code below:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/accounts"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TODO: You should probably not fetch the password...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" query "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM accounts ORDER BY username"')]),t._v("\n    db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" accounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If something went wrong, send back status code 500.")]),t._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Otherwise, send back all accounts in JSON format.")]),t._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("accounts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n")])])]),s("p",[t._v("Try sending a GET request to "),s("code",[t._v("/accounts")]),t._v(" in Postman to verify that it works. Remember that you need to restart your backend each time you change the JavaScript code in it.")]),t._v(" "),s("h3",{attrs:{id:"fetching-a-single-account"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fetching-a-single-account"}},[t._v("#")]),t._v(" Fetching a single account")]),t._v(" "),s("p",[t._v("To let clients fetch an account with a specific id, they can send a GET request to "),s("code",[t._v("/accounts/THE_ID")]),t._v(", e.g. "),s("code",[t._v("/accounts/5")]),t._v(". When the backend receives this request, it needs to fetch the account with this id from the database and send it back in JSON format. To make that happen, you can use the code below:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/accounts/:id"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TODO: You should probably not fetch the password...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" query "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM accounts WHERE id = ?"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" values "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" values"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" account")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If something went wrong, send back status code 500.")]),t._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("account"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If no account with that id existed.")]),t._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Otherwise, send back the account in JSON format.")]),t._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("account"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n")])])]),s("p",[t._v("Try sending a GET request to "),s("code",[t._v("/accounts/1")]),t._v(" and "),s("code",[t._v("/accounts/6876868")]),t._v(" in Postman to verify that it works. Remember that you need to restart your backend each time you change the JavaScript code in it.")]),t._v(" "),s("h3",{attrs:{id:"creating-accounts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-accounts"}},[t._v("#")]),t._v(" Creating accounts")]),t._v(" "),s("p",[t._v("To let clients create new accounts, they can send a POST request to "),s("code",[t._v("/accounts")]),t._v(", and in the body pass information about the account to be created in JSON format, e.g. "),s("code",[t._v('{"username": "Alice", "password": "abc123"}')]),t._v(". They also need to use the "),s("code",[t._v("Content-Type")]),t._v(" header with the value "),s("code",[t._v("application/json")]),t._v(". When the backend receives this request, it needs to read the information from the body of the request and then insert that information as a new account in the database, and then send back a response to the client.")]),t._v(" "),s("p",[t._v("To be able to read bodies written in JSON format, you need to add a middleware function from the npm package "),s("code",[t._v("body-parser")]),t._v(":")]),t._v(" "),s("ol",[s("li",[t._v("Open a terminal/shell/console and navigate to your project folder.")]),t._v(" "),s("li",[t._v("Install the npm package "),s("code",[t._v("body-parser")]),t._v(" by running the following command:\n"),s("ul",[s("li",[s("code",[t._v("npm install body-parser")]),t._v(" - Installs the npm package "),s("code",[t._v("body-parser")])])])])]),t._v(" "),s("p",[t._v("Then use "),s("code",[t._v("body-parser")]),t._v(" in your backend to add a middleware function parsing JSON bodies:")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("Add the line "),s("code",[t._v("const bodyParser = require('body-parser')")]),t._v(".")]),t._v(" "),s("li",[t._v("Add the line "),s("code",[t._v("app.use(bodyParser.json())")]),t._v(".")])]),t._v(" "),s("p",[t._v("Then you can let clients create new accounts using the following code:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/accounts"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" account "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" query "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INSERT INTO accounts (username, password) VALUES (?, ?)"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" values "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("account"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" account"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" values"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastID\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Location"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/accounts/"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n")])])]),s("p",[t._v("Try adding Update and Delete operations for accounts on your own:")]),t._v(" "),s("ul",[s("li",[t._v("To update a resource, clients should send a PUT request, the URI should identify which resource that should be updated, and the body should contain the updated resource. Use "),s("code",[t._v('app.put("...", function(...){ ... })')]),t._v(" to listen for PUT requests.")]),t._v(" "),s("li",[t._v("To delete a resource, clients should send a DELETE request, and the URI should identify which resource that should be deleted. Use "),s("code",[t._v('app.delete("...", function(...){ ... })')]),t._v(" to listen for DELETE requests.")])]),t._v(" "),s("p",[t._v("Then add the other operations for the other type of resources you have. Note that we yet don't bother about authentication and authorization, so all clients should for now be allowed to whatever they want.")]),t._v(" "),s("p",[t._v("Don't forget to describe in your project report how the backend has been implemented.")]),t._v(" "),s("h2",{attrs:{id:"part-5-implementing-the-frontend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-5-implementing-the-frontend"}},[t._v("#")]),t._v(" Part 5: Implementing the Frontend")]),t._v(" "),s("p",[t._v("Before you start working on this part you are expected to view the following lectures:")]),t._v(" "),s("ul",[s("li",[s("RouterLink",{attrs:{to:"/lectures/sop-and-cors/"}},[t._v("SOP and CORS")])],1)]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("Implement the frontend application in Vue.js. You will not get any help with how to use Vue.js here (use what you learned from the laboratory work), but we will give you some instructions on how to communicate with the backend through its REST API.")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Remember")]),t._v(" "),s("p",[t._v("The frontend does not yet contain login functionality, so you can't implement that part of the frontend yet.")])]),t._v(" "),s("p",[t._v("Don't forget to describe in your project report how the frontend has been implemented.")]),t._v(" "),s("h3",{attrs:{id:"enabling-cors-on-the-backend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#enabling-cors-on-the-backend"}},[t._v("#")]),t._v(" Enabling CORS on the backend")]),t._v(" "),s("p",[t._v("To start with, web browsers will forbid the frontend to communicate with the backend due to the "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy",target:"_blank",rel:"noopener noreferrer"}},[t._v("Same-Origin Policy"),s("OutboundLink")],1),t._v(". To allow it, you need to add support for "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORS"),s("OutboundLink")],1),t._v(" to your backend application. In Express it's as easy as this (using the "),s("code",[t._v("*")]),t._v(" value in the CORS headers to allow any clients to do anything):")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Enable CORS.")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Allow client-side JS from the following websites to send requests to us:")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (not optimal, for better security, change * to the URI of your frontend)")]),t._v("\n\tresponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Origin"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Allow client-side JS to send requests with the following methods:")]),t._v("\n\tresponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Methods"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Allow client-side JS to send requests with the following headers:")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (needed for the Authorization and Content-Type headers)")]),t._v("\n\tresponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Headers"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Allow client-side JS to read the following headers in the response:")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (in addition to Cache-Control, Content-Language, Content-Type")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Expires, Last-Modified, Pragma).")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (needed for the Location header)")]),t._v("\n\tresponse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-Expose-Headers"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\n\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Note!")]),t._v(" "),s("p",[t._v("FireFox did before support the "),s("code",[t._v("*")]),t._v(" value only in the "),s("code",[t._v("Access-Control-Allow-Origin")]),t._v(" header, so if you wanted to support Firefox you needed to list the values you want to allow in the other 3 headers, e.g. "),s("code",[t._v('response.setHeader("Access-Control-Allow-Headers", "Authorization, Content-Type")')]),t._v(" instead of using "),s("code",[t._v("*")]),t._v(", but "),s("a",{attrs:{href:"https://bugzilla.mozilla.org/show_bug.cgi?id=1309358",target:"_blank",rel:"noopener noreferrer"}},[t._v("support for the "),s("code",[t._v("*")]),t._v(" value was added in FireFox 69"),s("OutboundLink")],1),t._v(". If you want to support older versions of FireFox, you need to list the supported values instead of using "),s("code",[t._v("*")]),t._v(".")])]),t._v(" "),s("h3",{attrs:{id:"sending-http-requests-from-the-frontend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sending-http-requests-from-the-frontend"}},[t._v("#")]),t._v(" Sending HTTP requests from the frontend")]),t._v(" "),s("p",[t._v("To send HTTP requests from your Vue.js application you can either use "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/Guide/AJAX/Getting_Started",target:"_blank",rel:"noopener noreferrer"}},[t._v("the old XMLHttpRequest object"),s("OutboundLink")],1),t._v(" or "),s("a",{attrs:{href:"https://davidwalsh.name/fetch",target:"_blank",rel:"noopener noreferrer"}},[t._v("the new "),s("code",[t._v("fetch()")]),t._v(" function"),s("OutboundLink")],1),t._v(". Below you find example of how to use each of them.")]),t._v(" "),s("Tabs",[s("Tab",{attrs:{title:"XMLHttpRequest"}},[s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" request "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Specify method and URI.")]),t._v("\nrequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"POST"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://localhost:3000/accounts"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add headers to the request.")]),t._v("\nrequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/json"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add a callback function that will be called when")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// we receive back the response.")]),t._v("\nrequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'load'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" statusCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyAsString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyAsJsObject "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyAsString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" locationHeader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getResponseHeader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Location"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add a callback function that will be called if")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the communication with the server fails.")]),t._v("\nrequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Request failed :(")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Specify body and send it.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" accountToBeCreated "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    username"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Alice"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    password"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"abc123"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyAsString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("accountToBeCreated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nrequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyAsString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("Tab",{attrs:{title:"fetch()"}},[s("p",[t._v("You're not expected to learn how promises works in this course, but if you're curios you can learn the basics about promises on your own by reading the article "),s("a",{attrs:{href:"https://hackernoon.com/understanding-promises-in-javascript-13d99df067c1",target:"_blank",rel:"noopener noreferrer"}},[t._v("Understanding promises in JavaScript"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("The benefits with using promises instead of callback function is that you can chain them. You can learn about how to chain promises by reading the article "),s("a",{attrs:{href:"https://javascript.info/promise-chaining",target:"_blank",rel:"noopener noreferrer"}},[t._v("Promises chaining"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("And of course you also need to learn how to use the "),s("code",[t._v("fetch()")]),t._v(" function works. You can do that in the article "),s("a",{attrs:{href:"https://developers.google.com/web/updates/2015/03/introduction-to-fetch",target:"_blank",rel:"noopener noreferrer"}},[t._v("Introduction to fetch()"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" accountToBeCreated "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    username"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Alice"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    password"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"abc123"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyAsString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("accountToBeCreated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://localhost:3000/accounts"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    method"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    body"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" bodyAsString\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" statusCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" locationHeader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Location"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("bodyAsJsObject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Called when something goes wrong :(")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("Tab",{attrs:{title:"fetch() with async and await"}},[s("p",[t._v("The main benefit with promises is that we can use the "),s("code",[t._v("async")]),t._v(" and "),s("code",[t._v("await")]),t._v(" keywords in JavaScript instead of chaining them. This way, we end up writing code that looks to run synchronously (and hence very easy to read â˜º), but it will run asynchronously (hence not blocking â˜º).")]),t._v(" "),s("p",[t._v("To learn how to use "),s("code",[t._v("async")]),t._v("/"),s("code",[t._v("await")]),t._v(" you can read the article "),s("a",{attrs:{href:"https://medium.com/javascript-in-plain-english/async-await-javascript-5038668ec6eb",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to use Async Await in JavaScript."),s("OutboundLink")],1),t._v(". Using promises with "),s("code",[t._v("async")]),t._v("/"),s("code",[t._v("await")]),t._v(" is probably easier than learning how to chain promises, so don't be afraid of trying.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createAccount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("accountToBeCreated")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyAsString "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("accountToBeCreated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://localhost:3000/accounts"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        method"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Headers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        body"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" bodyAsString\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" statusCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" locationHeader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Location"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyAsJsObject "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" bodyAsObject\n    \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Use this in an async function.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (the async keyword cna only be used in async functions)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyAsObject "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createAccount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        username"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Alice"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        password"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"abc123"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Called when something goes wrong :(")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])])])],1),t._v(" "),s("h2",{attrs:{id:"part-6-adding-login-to-the-rest-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-6-adding-login-to-the-rest-api"}},[t._v("#")]),t._v(" Part 6: Adding Login to the REST API")]),t._v(" "),s("p",[t._v("Before you start working on this part you are expected to view the following lectures:")]),t._v(" "),s("ul",[s("li",[s("RouterLink",{attrs:{to:"/lectures/rest-api-authorization/"}},[t._v("REST API Authorization")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/json-web-tokens/"}},[t._v("JSON Web Tokens")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/lectures/third-party-authentication/"}},[t._v("Third-Party Authentication")])],1)]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("Add authentication and authorization to the REST API in your project report as described by the "),s("a",{attrs:{href:"https://oauth.net/2/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OAuth 2.0 Framework"),s("OutboundLink")],1),t._v(" and "),s("a",{attrs:{href:"https://openid.net/connect/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenID Connect"),s("OutboundLink")],1),t._v(". You basically need to:")]),t._v(" "),s("ul",[s("li",[t._v('Add one request clients can use to "login" to an account (to obtain an access token and an id token).\n'),s("ul",[s("li",[t._v("Clients also need to know which claims the id token contains.")])])]),t._v(" "),s("li",[t._v("Describe how clients can pass the access token to the backend in requests.")]),t._v(" "),s("li",[t._v("Describe which clients that are allowed to perform which operations in the API.")])]),t._v(" "),s("p",[t._v("You only need to support the "),s("em",[t._v("Authorization Grant")]),t._v(" called "),s("em",[t._v("Resource Owner Password Credentials")]),t._v(". Follow the details in the specification as much as possible.")]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("Report Feedback")]),t._v(" "),s("p",[t._v("You may "),s("a",{attrs:{href:"https://pingpong.hj.se/courseId/21410/content.do?id=16690466",target:"_blank",rel:"noopener noreferrer"}},[t._v("submit your report on Ping Pong and get some feedback on it"),s("OutboundLink")],1),t._v(" once before you submit your project work for grading at the end of the course. When you have come this far in your project work it is probably a good idea to do that. Note that you only have until 2019-10-04 to submit your report for feedback.")])]),t._v(" "),s("h2",{attrs:{id:"part-7-implementing-login-in-express"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-7-implementing-login-in-express"}},[t._v("#")]),t._v(" Part 7: Implementing Login in Express")]),t._v(" "),s("p",[t._v("Implement authentication and authorization in the Express application the way you describe it in the previous part. You should also change the code to store hash values of the users passwords, instead of storing them as plain text. Here we give you some hints about how to accomplish this.")]),t._v(" "),s("h3",{attrs:{id:"adding-login-creating-tokens"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-login-creating-tokens"}},[t._v("#")]),t._v(" Adding login/Creating tokens")]),t._v(" "),s("p",[t._v("According to the OAuth 2.0 specification, when a user logs in with a username and password, they should send it to the server in the body of the request in the data format "),s("code",[t._v("application/x-www-form-urlencoded")]),t._v(". This is the same data format that is used in the querystring, e.g. "),s("code",[t._v("variable1=value1&variable2=value2&...")]),t._v(". When the backend receives such a request, it needs to parse the body written in that data format. This can be added to Express using a middleware from the npm package "),s("code",[t._v("body-parser")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyParser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'body-parser'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyParser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("urlencoded")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    extended"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("When you have added this middleware, "),s("code",[t._v("request.body")]),t._v(" will be populated with information from the body, e.g.:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Body: variable1=value1&variable2=value2")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/tokens'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" variable1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("variable1 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// value1")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" variable2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("variable2 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// value2")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("You need to check that the body contains a variable called "),s("code",[t._v("grant_type")]),t._v(" with the value "),s("code",[t._v("password")]),t._v(". If that's not the case, then the user tries to login in one of the other ways described in OAuth 2.0 that we don't support, and we should send back an error response (see the specification for the details).")]),t._v(" "),s("p",[t._v("If "),s("code",[t._v("grant_type")]),t._v(" has the value "),s("code",[t._v("password")]),t._v(", then the body should also contain the variables "),s("code",[t._v("username")]),t._v(" and "),s("code",[t._v("password")]),t._v(". If that's not the case, then something is wrong with the request and we should send back an error response (see the specification for the details).")]),t._v(" "),s("p",[t._v("If "),s("code",[t._v("grant_type")]),t._v(" has the value "),s("code",[t._v("password")]),t._v(" and the body also contains the variables "),s("code",[t._v("username")]),t._v(" and "),s("code",[t._v("password")]),t._v(", then we need to fetch the account from the database with the given "),s("code",[t._v("username")]),t._v(" and see if the "),s("code",[t._v("password")]),t._v(" matches. If  no account with that username exists, or if the password is wrong, we should send back an error response (see the specification for the details).")]),t._v(" "),s("p",[t._v("Otherwise, if everything is OK and the user should be signed in, we need to create an access token the user can send to the backend in the future as a proof of being signed in to a specific account. We can implement these access tokens as "),s("a",{attrs:{href:"https://jwt.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON Web Tokens"),s("OutboundLink")],1),t._v(" (JWT). To create a new JWT, we can use the npm package "),s("a",{attrs:{href:"https://www.npmjs.com/package/jsonwebtoken",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("jsonwebtoken")]),s("OutboundLink")],1),t._v(". To install it, run the command "),s("code",[t._v("npm install jsonwebtoken")]),t._v(" in the root folder of your backend application. Then you can use it like this:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" jwt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jsonwebtoken'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" jwtSecret "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"some_random_characters"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dataToPutInTheToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// AKA "claims" and "payload".')]),t._v("\n    country"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sweden"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" accessToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jwt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sign")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataToPutInTheToken"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jwtSecret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb3VudHJ5IjoiU3dlZGVuIn0.k6rz1VHMIg3YvFpm4JMy78RUnFBUCPQPRoRXa2HlRjs"')]),t._v("\n")])])]),s("p",[t._v("In the access token you probably want to put something that identifies the user, such as the user's account id, and then send it back to the client (see the specification for the details).")]),t._v(" "),s("p",[t._v("When you're done you can use Postman to test if you can login and get back an access token. If you do, you can then use "),s("a",{attrs:{href:"https://jwt.io/#debugger-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("the debugger at jwt.io"),s("OutboundLink")],1),t._v(" to verify that the token contains expected data.")]),t._v(" "),s("h3",{attrs:{id:"receiving-and-extracting-tokens"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#receiving-and-extracting-tokens"}},[t._v("#")]),t._v(" Receiving and extracting tokens")]),t._v(" "),s("p",[t._v("When a client in the future sends requests to the backend and need to prove that she's the owner of a specific account, she can pass the access token in the "),s("code",[t._v("Authorization")]),t._v(" header, e.g. "),s("code",[t._v("Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb3VudHJ5IjoiU3dlZGVuIn0.k6rz1VHMIg3YvFpm4JMy78RUnFBUCPQPRoRXa2HlRjs")]),t._v(". When the backend receives that request it needs to extract the access token from this header and then extract the data from the token that you put inside of it before. You can do that like this:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" jwt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jsonwebtoken'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" jwtSecret "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"some_random_characters"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Same secret as before.")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/some-protected-resource"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" dataInToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" authorizationHeader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Authorization"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// E.g. "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb3VudHJ5IjoiU3dlZGVuIn0.k6rz1VHMIg3YvFpm4JMy78RUnFBUCPQPRoRXa2HlRjs"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" accessToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" authorizationHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("substr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Bearer "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// E.g. "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb3VudHJ5IjoiU3dlZGVuIn0.k6rz1VHMIg3YvFpm4JMy78RUnFBUCPQPRoRXa2HlRjs"')]),t._v("\n        dataInToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jwt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("verify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("accessToken"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jwtSecret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// E.g. {country: "Sweden"}')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Access token not present or invalid.")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataInToken"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// We received a valid access token :D")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// We didn't receive an access token or the received access token was invalid :(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("After we have extracted the data from the token we can figure out to which account the user logged in to before, and then figure out if the user is authorized to make the request or not.")]),t._v(" "),s("p",[t._v("When you have added authorization checks to your code you can use Postman to send requests with the Authorization header containing the access token and see if it works as it should. You can also use "),s("a",{attrs:{href:"https://jwt.io/#debugger-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("the debugger at jwt.io"),s("OutboundLink")],1),t._v(" to create invalid access tokens and see if your backend properly detects them as invalid.")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Avoiding copy-pasting code")]),t._v(" "),s("p",[t._v("Extracting the access token from the "),s("code",[t._v("Authorization")]),t._v(" header like that and then extract the data from the access token is something you want to do in many of the requests your backend receives, so instead of copy-pasting all of this code it is better to put it in a function and then call the function when you need to extract it (or even better: use a middleware function).")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Note!")]),t._v(" "),s("p",[t._v("One should rather use "),s("code",[t._v("jwt.sign()")]),t._v(" and "),s("code",[t._v("jwt.verify()")]),t._v(" asynchronously by providing a callback function, but to simplify we used them synchronously instead (they send back a return value). By using them synchronously they are blocking, so concurrent incoming HTTP requests are queued instead of handled immediately (the calls to "),s("code",[t._v("jwt.sign()")]),t._v(" and "),s("code",[t._v("jwt.verify()")]),t._v(" takes many milliseconds to execute). The call to these functions with a callback function are not blocking (the long running operations are executed in the background/another thread), and therefor better to use.")])]),t._v(" "),s("h3",{attrs:{id:"adding-openid-connect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-openid-connect"}},[t._v("#")]),t._v(" Adding OpenID Connect")]),t._v(" "),s("p",[t._v("When a client logs in and receives back an access token, the client does probably also want to know to which account the user logged into, so the client knows the username of the account, the id of the account, etc. For that we can use "),s("a",{attrs:{href:"https://openid.net/connect/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenID Connect"),s("OutboundLink")],1),t._v(". It specifies that when the client logs in, we do not only send back an access token, but also an id token that contains information about who the user is. Unlike access tokens, id tokens have to be implemented as JWT.")]),t._v(" "),s("p",[t._v("You get to decide what you want to put in your id token, but follow the specification as much as possible.")]),t._v(" "),s("p",[t._v("When you're done you can use Postman and see if you also get back an id token when you login. If you do you can use "),s("a",{attrs:{href:"https://jwt.io/#debugger-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("the debugger at jwt.io"),s("OutboundLink")],1),t._v(" to verify that the token contains expected information.")]),t._v(" "),s("h3",{attrs:{id:"hashing-passwords"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hashing-passwords"}},[t._v("#")]),t._v(" Hashing passwords")]),t._v(" "),s("p",[t._v("Storing passwords in plain text is a bad idea. Users often use the same password on different platforms, and if their passwords on our platform are leaked (by accident or by a hacker that has manage to hack our platform), anyone can login on their accounts on the other platforms they are using. Quite bad!")]),t._v(" "),s("p",[t._v("Instead, passwords should be hashed, and we should only store the hash value of their passwords. There exists many different hashing algorithms, but one of the best ones to use for hashing passwords is "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Bcrypt",target:"_blank",rel:"noopener noreferrer"}},[t._v("bcrypt"),s("OutboundLink")],1),t._v(". Many hashing algorithms are designed to be fast, so the hash value quickly can be computed, but that is not suitable for passwords, because then hackers can use "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Brute-force_attack",target:"_blank",rel:"noopener noreferrer"}},[t._v("brute-force"),s("OutboundLink")],1),t._v(" to figure out what the original password was. bcrypt on the other hand has intentionally been designed to be slow to prevent this, and you can control how slow it should be (so you can make it even slower in the future when computers have become faster).")]),t._v(" "),s("p",[t._v("To use bcrypt in Node.js you can use the npm package "),s("a",{attrs:{href:"https://www.npmjs.com/package/bcryptjs",target:"_blank",rel:"noopener noreferrer"}},[t._v("bcryptjs"),s("OutboundLink")],1),t._v(":")]),t._v(" "),s("ol",[s("li",[t._v("Download the npm package to your backend application:\n"),s("ul",[s("li",[t._v("In the root folder of your backend application, run the command "),s("code",[t._v("npm install bcryptjs")]),t._v(".")])])]),t._v(" "),s("li",[t._v("When creating a new account, hash the user's password using:")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bcrypt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bcryptjs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hashingRounds "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// How slow it should be (the higher number the slower).")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" passwordToHash "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"abc123"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hashValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bcrypt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hashSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("passwordToHash"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hashingRounds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "$2y$08$qc1V89V0GAstCI/NAMM4HO4DcP9Jwgk/h/WX2JsgvTIZqXRw6vxAK"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Store hashValue with the user's account in the database instead of passwordToHash.")]),t._v("\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("When the user logs in, fetch the user's "),s("code",[t._v("hashValue")]),t._v(" from the database and see if the provided password matches that one:")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bcrypt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bcryptjs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" usersEnteredPassword "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"abc123"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" storedHashValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$2y$08$qc1V89V0GAstCI/NAMM4HO4DcP9Jwgk/h/WX2JsgvTIZqXRw6vxAK"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Fetched from database.")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bcrypt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("compareSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("usersEnteredPassword"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" storedHashValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Correct password.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Wrong password.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("When you're done, use Postman to create some new accounts and then try to login to these.")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Remember")]),t._v(" "),s("p",[t._v("The old accounts in your database contains tha password in plain text, so you should not be able to login to them anymore. Feel free to delete these.")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Note!")]),t._v(" "),s("p",[t._v("To simplify, many things you should think of for a real platform has been ignored in the instructions above, but here are short descriptions of these things for the curious ones:")]),t._v(" "),s("p",[t._v("One should rather use the npm package "),s("code",[t._v("bcrypt")]),t._v(" instead of "),s("code",[t._v("bcryptjs")]),t._v(". The JavaScript you write to use them is the same, but "),s("code",[t._v("bcryptjs")]),t._v(" has been implemented in JavaScript, making it 30% slower than "),s("code",[t._v("bcrypt")]),t._v(", which is implemented in C, so it is better to use "),s("code",[t._v("bcrypt")]),t._v(". But "),s("a",{attrs:{href:"https://github.com/kelektiv/node.bcrypt.js#dependencies",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("bcrypt")]),t._v(" has some dependencies"),s("OutboundLink")],1),t._v(" making it a bit harder to use.")]),t._v(" "),s("p",[t._v("One should rather use the asynchronous functions "),s("code",[t._v("hash()")]),t._v(" and "),s("code",[t._v("compare()")]),t._v(" instead of the synchronous "),s("code",[t._v("hashSync()")]),t._v(" and "),s("code",[t._v("compareSync()")]),t._v(". The synchronous functions are easier to use (return values instead of callback functions), but they are blocking, so concurrent incoming HTTP requests are queued instead of handled immediately. The asynchronous functions compute the hash values in the background/in another thread, so they don't have this shortage.")]),t._v(" "),s("p",[t._v("You should most likely not use "),s("code",[t._v("8")]),t._v(" as the number of hashing rounds (too low), but "),s("a",{attrs:{href:"https://security.stackexchange.com/a/3993/70743",target:"_blank",rel:"noopener noreferrer"}},[t._v("it is a bit complicated to find out the optimal number of rounds to use"),s("OutboundLink")],1),t._v(", and to do that you also need to know which server your backend will be running on in the end, and since deploying a backend on a server is not part of this course, we don't have all the details to compute it.")])]),t._v(" "),s("h2",{attrs:{id:"part-8-adding-login-to-the-frontend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-8-adding-login-to-the-frontend"}},[t._v("#")]),t._v(" Part 8: Adding Login to the Frontend")]),t._v(" "),s("p",[t._v("Now that the backend have login functionality through access tokens and id tokens, use this login functionality in the frontend application. When you're done, users should only be able to do what they should be able to. For example, a user should not be able to delete another user's account, or similar.")]),t._v(" "),s("p",[t._v("You are recommended to keep track of wether the user is logged in or not the same way as you did in the lab, i.e. in add a "),s("code",[t._v("user")]),t._v(" object to "),s("code",[t._v("App.vue")]),t._v(" and pass this as a props to your other Vue components.")]),t._v(" "),s("p",[t._v("When the user successfully logs in you get back an id token with information about the user (it's id, username, etc.). You need to open up this JWT and read out the information from it. You can't do that with the npm package "),s("code",[t._v("jsonwebtoken")]),t._v(" (that you used in your backend), because it only works in Node.js, and not in web browsers. Instead, you can use the npm package "),s("code",[t._v("jwt-decode")]),t._v(":")]),t._v(" "),s("ol",[s("li",[t._v("In the root folder of your frontend application, run the command "),s("code",[t._v("npm install jwt-decode")]),t._v(".")]),t._v(" "),s("li",[t._v("To read out the data from the id token, use the function this npm package consists of:")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" jwtDecode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jwt-decode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" idToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjQsInByZWZlcnJlZF91c2VybmFtZSI6IkFsaWNlIn0.3Xp7iQkttgTE6hpuT28LFdZ7EYWHlPndqdaWoIzTr9A"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dataInIdToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("jwtDecode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("idToken"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// E.g. {sub: 4, preferred_username: "Alice"} ')]),t._v("\n")])])]),s("h2",{attrs:{id:"part-9-presentation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-9-presentation"}},[t._v("#")]),t._v(" Part 9: Presentation")]),t._v(" "),s("p",[t._v("Present your platform to the rest of your class using a projector. The reason for the presentation is two-folded:")]),t._v(" "),s("ul",[s("li",[t._v("You get some practice in presenting your work, which is a very important skill in your future professional career.")]),t._v(" "),s("li",[t._v("You get to see other platforms that you should be able to implement yourself.")])]),t._v(" "),s("p",[t._v("At the presentation you will simply tell the audience what users can do on your platform and why someone would like to do that, and then show how users can use the platform through the frontend application. You should not show any code nor explain any implementation details; just give a practical demonstration of how users will use the platform. The best way to do that is by having one of you speaking and telling the other one what to do (e.g. "),s("em",[t._v("Create a new account")]),t._v("), and then the other shows how to do that.")]),t._v(" "),s("p",[t._v("To be allowed to present your work your you must at least be done with Part 5.")]),t._v(" "),s("p",[t._v("You may use at most 10 minutes for your presentation. If you need more than this to show all features, then skip some of them. If your presentation takes just 3 minutes, that could be OK as well. Don't start talking about irrelevant things just to make the presentation longer.")]),t._v(" "),s("p",[t._v("If you can't present your work on your own laptop, email the course coordinator and he will help you.")]),t._v(" "),s("p",[t._v("There are 3 different sessions for the demonstration, and you need to present your platform one of them. Select which one by "),s("a",{attrs:{href:"https://pingpong.hj.se/courseId/21410/projectGroupsList.do",target:"_blank",rel:"noopener noreferrer"}},[t._v("joining the corresponding project group on Ping Pong"),s("OutboundLink")],1),t._v(" (first come, first served).")]),t._v(" "),s("p",[t._v("Your presentation will not be graded; consider it as (mandatory) practice.")]),t._v(" "),s("h2",{attrs:{id:"part-10-grade-4-and-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-10-grade-4-and-5"}},[t._v("#")]),t._v(" Part 10: Grade 4 and 5")]),t._v(" "),s("p",[t._v("Be sure to read through "),s("RouterLink",{attrs:{to:"/courses/client-server-communication/project-grading-guidelines/"}},[t._v("Project Grading Guidelines")]),t._v(" to see that you follow the guidelines for grade you're aiming for. To be able get grade 4 and 5 you also need to implement the extra functionality described next.")],1),t._v(" "),s("h3",{attrs:{id:"sdk-required-for-grade-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sdk-required-for-grade-4"}},[t._v("#")]),t._v(" SDK (required for grade 4)")]),t._v(" "),s("p",[t._v("Create an SDK other programmers can use to communicate with your backend from their client-side JavaScript code. Then also use it in your own frontend.")]),t._v(" "),s("p",[t._v("Also update the report to reflect this.")]),t._v(" "),s("h3",{attrs:{id:"supporting-multiple-data-formats-required-for-grade-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#supporting-multiple-data-formats-required-for-grade-4"}},[t._v("#")]),t._v(" Supporting Multiple Data Formats (required for grade 4)")]),t._v(" "),s("p",[t._v("Add support for another data format in addition to JSON (+ www-form-urlencoded for logging in). This should work in both requests and responses, so when you receive a request you need to look at the "),s("code",[t._v("Content-Type")]),t._v(" header to figure out which format the body in the request is written in, and you also need to look at the "),s("code",[t._v("Accept")]),t._v(" header to figure out in which format you should send back the body in the response in.")]),t._v(" "),s("p",[t._v("Example of data formats you can support:")]),t._v(" "),s("ul",[s("li",[t._v("XML")]),t._v(" "),s("li",[t._v("YAML")])]),t._v(" "),s("p",[t._v("Try to "),s("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("find a suitable npm package"),s("OutboundLink")],1),t._v(" doing most of the work for you.")]),t._v(" "),s("p",[t._v("Also update your report to reflect this.")]),t._v(" "),s("h4",{attrs:{id:"guidelines-parsing-the-body-of-incoming-http-request"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#guidelines-parsing-the-body-of-incoming-http-request"}},[t._v("#")]),t._v(" Guidelines parsing the body of incoming HTTP request")]),t._v(" "),s("p",[t._v("Each time you receive an HTTP request with a body, check the "),s("code",[t._v("Content-Type")]),t._v(" of the incoming HTTP request. If the content type is "),s("code",[t._v("application/yaml")]),t._v(", then the resource in the body of the request has been written in YAML format. Then you need to read the body of the quest into a string, and then parse it as YAML code, then you have your resource as a JavaScript object. How to read the body into a strings is described in the lecture "),s("RouterLink",{attrs:{to:"/lectures/web-applications-in-node-js/"}},[t._v("Web Applications in Node.js")]),t._v(". Find an npm package you can use to do the parsing of YAML code for you.")],1),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Tips!")]),t._v(" "),s("p",[t._v("You need to do this for all incoming HTTP requests with a body, so the best way to implement it is as a middleware function. In your middleware function, after you have obtained the resource from the body as a JavaScript object, assign it to "),s("code",[t._v("request.body")]),t._v(" so your ordinary request handler functions in "),s("code",[t._v("app.post(...)")]),t._v(" and "),s("code",[t._v("app.put(...)")]),t._v(" can obtain the resource through "),s("code",[t._v("request.body")]),t._v(".")])]),t._v(" "),s("h4",{attrs:{id:"sending-back-responses-in-correct-data-format"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sending-back-responses-in-correct-data-format"}},[t._v("#")]),t._v(" Sending back responses in correct data format")]),t._v(" "),s("p",[t._v("You can't always call "),s("code",[t._v("response.json(theResource)")]),t._v(" to send back the resource. You should only use "),s("code",[t._v("response.json(...)")]),t._v(" if the "),s("code",[t._v("Accept")]),t._v(" header in the request is "),s("code",[t._v("application/json")]),t._v(". If the "),s("code",[t._v("Accept")]),t._v(" header instead is "),s("code",[t._v("application/yaml")]),t._v(", you should send it back in YAML format. To convert the resource to a string with YAML code, use a suitable npm package. To send back the string with the YAML code, use "),s("code",[t._v('response.end("THE YAML CODE")')]),t._v(".")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Tips!")]),t._v(" "),s("p",[t._v("You need to do this for all outgoing HTTP responses with a body, so the best way to implement it is as a function doing something like this:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Accept header in request is application/json */")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Send back the resource in JSON format.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Accept header in request is application/yaml */")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Send back the resource in YAML format.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Send back the resource in your chosen default format.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("h3",{attrs:{id:"third-party-authentication-required-for-grade-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#third-party-authentication-required-for-grade-5"}},[t._v("#")]),t._v(" Third-Party Authentication (required for grade 5)")]),t._v(" "),s("p",[t._v("Add third-party authentication to your application so users can login on your platform with their Google account (or whichever third-party you choose to use) instead of using a username and password. You need to implement this in your backend application and then use it in your frontend application as well.")]),t._v(" "),s("p",[t._v("Also update your report to reflect this.")]),t._v(" "),s("h2",{attrs:{id:"part-11-final-submission"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#part-11-final-submission"}},[t._v("#")]),t._v(" Part 11: Final submission")]),t._v(" "),s("p",[t._v("Submit your project work for grading by submitting "),s("a",{attrs:{href:"https://pingpong.hj.se/courseId/21410/content.do?id=16690476",target:"_blank",rel:"noopener noreferrer"}},[t._v("the Ping Pong assignment Project Work - Final Submission"),s("OutboundLink")],1),t._v(". The source code for your backend and frontend should be submitted as two separate ZIP files, and they should not contain the "),s("code",[t._v("node_modules")]),t._v(" folder (you need to manually delete it). When those ZIP files have been unzipped on the examiner's own computer, it is very important that the applications can be started and are fully functional just by running the following two commands (for each of the applications):")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("npm install")])]),t._v(" "),s("li",[s("code",[t._v("node app.js")]),t._v(" or "),s("code",[t._v("npm run serve")]),t._v(" (or whatever)")])]),t._v(" "),s("p",[t._v("If this does not work you need to submit your work again at the next examination occasion, so double check that this work yourself before you submit your work!")])],1)}),[],!1,null,null,null);e.default=n.exports}}]);