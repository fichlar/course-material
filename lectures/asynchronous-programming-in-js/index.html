<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Asynchronous Programming in JavaScript</title>
    <meta name="generator" content="VuePress 1.5.3">
    
    <meta name="description" content="">
    <link rel="preload" href="/course-material/assets/css/0.styles.acf56494.css" as="style"><link rel="preload" href="/course-material/assets/js/app.222f1d4d.js" as="script"><link rel="preload" href="/course-material/assets/js/2.873e2bc6.js" as="script"><link rel="preload" href="/course-material/assets/js/8.9228a913.js" as="script"><link rel="preload" href="/course-material/assets/js/10.1cd6f68e.js" as="script"><link rel="preload" href="/course-material/assets/js/13.b01bcf64.js" as="script"><link rel="preload" href="/course-material/assets/js/5.ea5235af.js" as="script"><link rel="preload" href="/course-material/assets/js/7.b6e5d6eb.js" as="script"><link rel="prefetch" href="/course-material/assets/js/100.1432f700.js"><link rel="prefetch" href="/course-material/assets/js/101.e586ec2e.js"><link rel="prefetch" href="/course-material/assets/js/102.f6feb9ee.js"><link rel="prefetch" href="/course-material/assets/js/103.20138032.js"><link rel="prefetch" href="/course-material/assets/js/104.49ee690f.js"><link rel="prefetch" href="/course-material/assets/js/105.d66e4144.js"><link rel="prefetch" href="/course-material/assets/js/106.87a3df3a.js"><link rel="prefetch" href="/course-material/assets/js/107.6d138433.js"><link rel="prefetch" href="/course-material/assets/js/108.632b22d3.js"><link rel="prefetch" href="/course-material/assets/js/109.50b743bf.js"><link rel="prefetch" href="/course-material/assets/js/11.2ba39447.js"><link rel="prefetch" href="/course-material/assets/js/110.d62c407b.js"><link rel="prefetch" href="/course-material/assets/js/111.15c362be.js"><link rel="prefetch" href="/course-material/assets/js/112.e4a3e814.js"><link rel="prefetch" href="/course-material/assets/js/113.8cd9357e.js"><link rel="prefetch" href="/course-material/assets/js/114.ab5e09b9.js"><link rel="prefetch" href="/course-material/assets/js/115.70ad79b6.js"><link rel="prefetch" href="/course-material/assets/js/116.c7c5f79f.js"><link rel="prefetch" href="/course-material/assets/js/117.9ec8e9cd.js"><link rel="prefetch" href="/course-material/assets/js/118.5b6012e7.js"><link rel="prefetch" href="/course-material/assets/js/119.f7e08d1a.js"><link rel="prefetch" href="/course-material/assets/js/12.1782acda.js"><link rel="prefetch" href="/course-material/assets/js/120.a2a9dd68.js"><link rel="prefetch" href="/course-material/assets/js/121.3e95efd1.js"><link rel="prefetch" href="/course-material/assets/js/122.6700147e.js"><link rel="prefetch" href="/course-material/assets/js/123.fc462e65.js"><link rel="prefetch" href="/course-material/assets/js/124.271b187d.js"><link rel="prefetch" href="/course-material/assets/js/125.b8b402a2.js"><link rel="prefetch" href="/course-material/assets/js/126.57eda972.js"><link rel="prefetch" href="/course-material/assets/js/127.d2b628d8.js"><link rel="prefetch" href="/course-material/assets/js/128.c66bd009.js"><link rel="prefetch" href="/course-material/assets/js/129.39c15bb8.js"><link rel="prefetch" href="/course-material/assets/js/130.7cc830b9.js"><link rel="prefetch" href="/course-material/assets/js/131.ef211a36.js"><link rel="prefetch" href="/course-material/assets/js/132.35405085.js"><link rel="prefetch" href="/course-material/assets/js/133.f51a1b7f.js"><link rel="prefetch" href="/course-material/assets/js/134.26b7a3e2.js"><link rel="prefetch" href="/course-material/assets/js/135.59e766b2.js"><link rel="prefetch" href="/course-material/assets/js/136.7c759a76.js"><link rel="prefetch" href="/course-material/assets/js/137.fbc3049c.js"><link rel="prefetch" href="/course-material/assets/js/138.3d59c3d1.js"><link rel="prefetch" href="/course-material/assets/js/139.0bdec4c7.js"><link rel="prefetch" href="/course-material/assets/js/14.ce38565c.js"><link rel="prefetch" href="/course-material/assets/js/140.61cb415c.js"><link rel="prefetch" href="/course-material/assets/js/141.464042a2.js"><link rel="prefetch" href="/course-material/assets/js/142.8714d254.js"><link rel="prefetch" href="/course-material/assets/js/143.81cf6274.js"><link rel="prefetch" href="/course-material/assets/js/144.923f61be.js"><link rel="prefetch" href="/course-material/assets/js/145.8818e5a0.js"><link rel="prefetch" href="/course-material/assets/js/146.293285b3.js"><link rel="prefetch" href="/course-material/assets/js/147.4b0aea91.js"><link rel="prefetch" href="/course-material/assets/js/148.af5fdc4d.js"><link rel="prefetch" href="/course-material/assets/js/149.596e6b46.js"><link rel="prefetch" href="/course-material/assets/js/15.7ec8ea15.js"><link rel="prefetch" href="/course-material/assets/js/150.a8475d5e.js"><link rel="prefetch" href="/course-material/assets/js/151.69f195d0.js"><link rel="prefetch" href="/course-material/assets/js/152.4071dd24.js"><link rel="prefetch" href="/course-material/assets/js/153.94a11816.js"><link rel="prefetch" href="/course-material/assets/js/154.66fc3155.js"><link rel="prefetch" href="/course-material/assets/js/155.a30d45d6.js"><link rel="prefetch" href="/course-material/assets/js/156.d10e90bf.js"><link rel="prefetch" href="/course-material/assets/js/157.54fd680a.js"><link rel="prefetch" href="/course-material/assets/js/158.0a6b5434.js"><link rel="prefetch" href="/course-material/assets/js/159.4e64ab5f.js"><link rel="prefetch" href="/course-material/assets/js/16.e819f8bf.js"><link rel="prefetch" href="/course-material/assets/js/160.f5d3f042.js"><link rel="prefetch" href="/course-material/assets/js/161.07e25925.js"><link rel="prefetch" href="/course-material/assets/js/162.bd804017.js"><link rel="prefetch" href="/course-material/assets/js/163.dbd26f1e.js"><link rel="prefetch" href="/course-material/assets/js/164.337057d8.js"><link rel="prefetch" href="/course-material/assets/js/165.dc26bd31.js"><link rel="prefetch" href="/course-material/assets/js/166.56cd68a4.js"><link rel="prefetch" href="/course-material/assets/js/167.38c4e2e8.js"><link rel="prefetch" href="/course-material/assets/js/168.89c31781.js"><link rel="prefetch" href="/course-material/assets/js/169.8cf03e08.js"><link rel="prefetch" href="/course-material/assets/js/17.039ade8f.js"><link rel="prefetch" href="/course-material/assets/js/170.557d07a1.js"><link rel="prefetch" href="/course-material/assets/js/171.c6958743.js"><link rel="prefetch" href="/course-material/assets/js/172.ead92356.js"><link rel="prefetch" href="/course-material/assets/js/173.0883e9a3.js"><link rel="prefetch" href="/course-material/assets/js/174.4538f0ea.js"><link rel="prefetch" href="/course-material/assets/js/175.b04a4020.js"><link rel="prefetch" href="/course-material/assets/js/176.230bc53d.js"><link rel="prefetch" href="/course-material/assets/js/177.cefe1816.js"><link rel="prefetch" href="/course-material/assets/js/178.c73870f5.js"><link rel="prefetch" href="/course-material/assets/js/18.0bde8c4c.js"><link rel="prefetch" href="/course-material/assets/js/19.b6290137.js"><link rel="prefetch" href="/course-material/assets/js/20.f022e68e.js"><link rel="prefetch" href="/course-material/assets/js/21.236d3ce4.js"><link rel="prefetch" href="/course-material/assets/js/22.c6a1864c.js"><link rel="prefetch" href="/course-material/assets/js/23.f44f7715.js"><link rel="prefetch" href="/course-material/assets/js/24.3959dc1a.js"><link rel="prefetch" href="/course-material/assets/js/25.b29b742e.js"><link rel="prefetch" href="/course-material/assets/js/26.991bc487.js"><link rel="prefetch" href="/course-material/assets/js/27.7a89d2f8.js"><link rel="prefetch" href="/course-material/assets/js/28.e682b359.js"><link rel="prefetch" href="/course-material/assets/js/29.48eb937b.js"><link rel="prefetch" href="/course-material/assets/js/3.4e64da92.js"><link rel="prefetch" href="/course-material/assets/js/30.ce10e16b.js"><link rel="prefetch" href="/course-material/assets/js/31.5a8e58ca.js"><link rel="prefetch" href="/course-material/assets/js/32.fc15045e.js"><link rel="prefetch" href="/course-material/assets/js/33.179e5f65.js"><link rel="prefetch" href="/course-material/assets/js/34.80bc02bd.js"><link rel="prefetch" href="/course-material/assets/js/35.7dd571d8.js"><link rel="prefetch" href="/course-material/assets/js/36.a5e994f6.js"><link rel="prefetch" href="/course-material/assets/js/37.2f96cfaa.js"><link rel="prefetch" href="/course-material/assets/js/38.bae72aa9.js"><link rel="prefetch" href="/course-material/assets/js/39.92cfd2fc.js"><link rel="prefetch" href="/course-material/assets/js/4.cdfde9c3.js"><link rel="prefetch" href="/course-material/assets/js/40.45ce9ee3.js"><link rel="prefetch" href="/course-material/assets/js/41.dbcbb3e3.js"><link rel="prefetch" href="/course-material/assets/js/42.14bbb776.js"><link rel="prefetch" href="/course-material/assets/js/43.5d99b089.js"><link rel="prefetch" href="/course-material/assets/js/44.caae39a9.js"><link rel="prefetch" href="/course-material/assets/js/45.9212b053.js"><link rel="prefetch" href="/course-material/assets/js/46.95a5d5fa.js"><link rel="prefetch" href="/course-material/assets/js/47.620a4a7f.js"><link rel="prefetch" href="/course-material/assets/js/48.dc62d8f3.js"><link rel="prefetch" href="/course-material/assets/js/49.c305d819.js"><link rel="prefetch" href="/course-material/assets/js/50.b293b05e.js"><link rel="prefetch" href="/course-material/assets/js/51.6f48123b.js"><link rel="prefetch" href="/course-material/assets/js/52.0b0e57c0.js"><link rel="prefetch" href="/course-material/assets/js/53.33c12c25.js"><link rel="prefetch" href="/course-material/assets/js/54.78ab01f3.js"><link rel="prefetch" href="/course-material/assets/js/55.9bddbf1c.js"><link rel="prefetch" href="/course-material/assets/js/56.640f19ab.js"><link rel="prefetch" href="/course-material/assets/js/57.3a6d92f2.js"><link rel="prefetch" href="/course-material/assets/js/58.7d7aeffd.js"><link rel="prefetch" href="/course-material/assets/js/59.1c18ae11.js"><link rel="prefetch" href="/course-material/assets/js/6.bbc3dad6.js"><link rel="prefetch" href="/course-material/assets/js/60.063d0ba9.js"><link rel="prefetch" href="/course-material/assets/js/61.95e973bf.js"><link rel="prefetch" href="/course-material/assets/js/62.fbffef79.js"><link rel="prefetch" href="/course-material/assets/js/63.ab0fa3ee.js"><link rel="prefetch" href="/course-material/assets/js/64.415132eb.js"><link rel="prefetch" href="/course-material/assets/js/65.aee76ada.js"><link rel="prefetch" href="/course-material/assets/js/66.892bf8d1.js"><link rel="prefetch" href="/course-material/assets/js/67.90f759fe.js"><link rel="prefetch" href="/course-material/assets/js/68.e86dc083.js"><link rel="prefetch" href="/course-material/assets/js/69.1562c78d.js"><link rel="prefetch" href="/course-material/assets/js/70.c75acdff.js"><link rel="prefetch" href="/course-material/assets/js/71.55460478.js"><link rel="prefetch" href="/course-material/assets/js/72.8cc6c918.js"><link rel="prefetch" href="/course-material/assets/js/73.d71accf0.js"><link rel="prefetch" href="/course-material/assets/js/74.f5218813.js"><link rel="prefetch" href="/course-material/assets/js/75.dbc23007.js"><link rel="prefetch" href="/course-material/assets/js/76.85c4eb87.js"><link rel="prefetch" href="/course-material/assets/js/77.c4333bde.js"><link rel="prefetch" href="/course-material/assets/js/78.eb0aff45.js"><link rel="prefetch" href="/course-material/assets/js/79.1a97dc57.js"><link rel="prefetch" href="/course-material/assets/js/80.3afcf6a5.js"><link rel="prefetch" href="/course-material/assets/js/81.ed786781.js"><link rel="prefetch" href="/course-material/assets/js/82.83da0601.js"><link rel="prefetch" href="/course-material/assets/js/83.44bfef3b.js"><link rel="prefetch" href="/course-material/assets/js/84.f2a2480b.js"><link rel="prefetch" href="/course-material/assets/js/85.5a0aa125.js"><link rel="prefetch" href="/course-material/assets/js/86.85955d2d.js"><link rel="prefetch" href="/course-material/assets/js/87.65ea4810.js"><link rel="prefetch" href="/course-material/assets/js/88.93c584a8.js"><link rel="prefetch" href="/course-material/assets/js/89.ae312857.js"><link rel="prefetch" href="/course-material/assets/js/9.a94e852b.js"><link rel="prefetch" href="/course-material/assets/js/90.06701947.js"><link rel="prefetch" href="/course-material/assets/js/91.cda322af.js"><link rel="prefetch" href="/course-material/assets/js/92.c8bf7438.js"><link rel="prefetch" href="/course-material/assets/js/93.2e6cc26d.js"><link rel="prefetch" href="/course-material/assets/js/94.3cc7916c.js"><link rel="prefetch" href="/course-material/assets/js/95.b6c8d4f1.js"><link rel="prefetch" href="/course-material/assets/js/96.18d3d8d1.js"><link rel="prefetch" href="/course-material/assets/js/97.a59eba2e.js"><link rel="prefetch" href="/course-material/assets/js/98.eb29aa8a.js"><link rel="prefetch" href="/course-material/assets/js/99.ab4aa743.js">
    <link rel="stylesheet" href="/course-material/assets/css/0.styles.acf56494.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <!----> <span class="site-name">
	Asynchronous Programming in JavaScript
</span> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/course-material/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Courses" class="dropdown-title"><span class="title">Courses</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/course-material/courses/android-development/" class="nav-link">
  Android Development 2021
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/client-server-communication/" class="nav-link">
  Client-Server Communication 2019
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/introduction-to-script-programming/" class="nav-link">
  Introduction to Script Programming 2020
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/web-development-advanced-concepts/" class="nav-link">
  Web Development - Advanced Concepts 2021
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/web-development-fundamentals/" class="nav-link">
  Web Development Fundamentals 2020
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/PeppeL-G/course-material/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Get Help
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/PeppeL-G/course-material" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/course-material/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Courses" class="dropdown-title"><span class="title">Courses</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/course-material/courses/android-development/" class="nav-link">
  Android Development 2021
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/client-server-communication/" class="nav-link">
  Client-Server Communication 2019
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/introduction-to-script-programming/" class="nav-link">
  Introduction to Script Programming 2020
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/web-development-advanced-concepts/" class="nav-link">
  Web Development - Advanced Concepts 2021
</a></li><li class="dropdown-item"><!----> <a href="/course-material/courses/web-development-fundamentals/" class="nav-link">
  Web Development Fundamentals 2020
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/PeppeL-G/course-material/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Get Help
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/PeppeL-G/course-material" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Asynchronous Programming in JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/course-material/lectures/asynchronous-programming-in-js/#what-is-synchronous-programming" class="sidebar-link">What is Synchronous Programming?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/course-material/lectures/asynchronous-programming-in-js/#what-s-the-problem-with-synchronous-programming" class="sidebar-link">What's the Problem with Synchronous Programming?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/course-material/lectures/asynchronous-programming-in-js/#problem-example-1-graphical-user-interfaces" class="sidebar-link">Problem Example 1: Graphical User Interfaces</a></li><li class="sidebar-sub-header"><a href="/course-material/lectures/asynchronous-programming-in-js/#problem-example-2-data-loading" class="sidebar-link">Problem Example 2: Data Loading</a></li></ul></li><li><a href="/course-material/lectures/asynchronous-programming-in-js/#what-is-asynchronous-programming" class="sidebar-link">What is Asynchronous Programming?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/course-material/lectures/asynchronous-programming-in-js/#asynchronous-programming-with-callback-functions" class="sidebar-link">Asynchronous Programming with Callback Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/course-material/lectures/asynchronous-programming-in-js/#error-handling" class="sidebar-link">Error Handling</a></li></ul></li><li><a href="/course-material/lectures/asynchronous-programming-in-js/#the-drawback-with-asynchronous-programming-with-callback-functions" class="sidebar-link">The Drawback with Asynchronous Programming with Callback Functions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/course-material/lectures/asynchronous-programming-in-js/#what-are-promises" class="sidebar-link">What are Promises?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/course-material/lectures/asynchronous-programming-in-js/#async-and-await" class="sidebar-link">Async and Await</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/course-material/lectures/asynchronous-programming-in-js/#how-to-create-promises" class="sidebar-link">How to Create Promises</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="asynchronous-programming-in-javascript"><a href="#asynchronous-programming-in-javascript" class="header-anchor">#</a> Asynchronous Programming in JavaScript</h1> <p>In this lecture we'll take a look at how synchronous programming differs from asynchronous programming, when you should use which one, and how we can use asynchronous programming in JavaScript through <em>callback functions</em>, <em>promises</em> and <em>promises with <code>async</code> and <code>wait</code></em>.</p> <h2 id="what-is-synchronous-programming"><a href="#what-is-synchronous-programming" class="header-anchor">#</a> What is Synchronous Programming?</h2> <p>When you first learned programming, <em>synchronous programming</em> is most likely what you learned. In synchronous programming, one thing is carried out at a time, and you don't start doing the next thing until the first thing is done. In JavaScript, that <em>thing</em> is a function, as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Example of a synchronous function.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>x<span class="token punctuation" data-v-2e29d265>,</span> y</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> sum <span class="token operator" data-v-2e29d265>=</span> x <span class="token operator" data-v-2e29d265>+</span> y
	<span class="token keyword" data-v-2e29d265>return</span> sum
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// Example of calls to a synchronous function.</span>
<span class="token keyword" data-v-2e29d265>const</span> sum1 <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>1</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>2</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token keyword" data-v-2e29d265>const</span> sum2 <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>3</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>)</span>

console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>sum1 <span class="token operator" data-v-2e29d265>+</span> sum2<span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of synchronous programming in JavaScript.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>In <span class="whole" data-v-650a815e><span class="decrementFigureNumber" data-v-650a815e></span> <span class="figureNumber" data-v-650a815e></span> <span class="incrementFigureNumber" data-v-650a815e></span></span> above, <code>getSum()</code> is a synchronous function. What that means is that when <code>getSum(1, 2)</code> is called on line 8, <code>getSum()</code> will do all it's work, and then return back the result and store it in <code>sum1</code>. Then we continue with the call <code>getSum(3, 4)</code> on line 9, and <code>getSum()</code> will again do it's entire work, and then return back the result, which we then store in <code>sum2</code>.</p> <p>This sounds obvious, right? Well, that's because it works the way you're used to.</p> <h2 id="what-s-the-problem-with-synchronous-programming"><a href="#what-s-the-problem-with-synchronous-programming" class="header-anchor">#</a> What's the Problem with Synchronous Programming?</h2> <p>The problem with synchronous programming occurs when we have <em>long running operations</em>. What counts as a long running operation depends on what type of application you create, but operations that takes more than a few milliseconds to complete usually count as long running. The problem with synchronous programming is that we can only run one long running operation at a time, and that can be problematic for our application. A few examples of this is given next.</p> <h3 id="problem-example-1-graphical-user-interfaces"><a href="#problem-example-1-graphical-user-interfaces" class="header-anchor">#</a> Problem Example 1: Graphical User Interfaces</h3> <!----> <p>One problem with synchronous programming occurs when we implement graphical user interfaces (GUI). Imagine the user clicks on a button, and we start to compute something that takes 3 seconds to compute. If we use synchronous programming, nothing else in our code during those 3 seconds would run, so the graphical user interface would freeze, so the user can't click on an abort button, nor do anything else. Want an example of this? Just click <button>this button</button> and then try to select text on this page, click on a link, or something, within 3 seconds (requires JavaScript to be enabled in your web browser).</p> <p>The code in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below explains the problem in detail.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// This is the function that is called when the button is clicked.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>handleClickOnButton</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token comment" data-v-2e29d265>// Imagine the sleep() function would exist, and calling it with</span>
	<span class="token comment" data-v-2e29d265>// 3000 would make the function wait 3000ms before it returned.</span>
	<span class="token function" data-v-2e29d265>sleep</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>3000</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token comment" data-v-2e29d265>// Then non of our code would execute during those 3000ms,</span>
	<span class="token comment" data-v-2e29d265>// and the GUI would freeze.</span>
	<span class="token comment" data-v-2e29d265>// (JS doesn't have a such stupid function, so it doesn't exist). </span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// The sleep function in this example is implemented like this</span>
<span class="token comment" data-v-2e29d265>// (we use a loop with very many iterations to simulate a long running operation):</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>sleep</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>sleepMs</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> timeToWakeUp <span class="token operator" data-v-2e29d265>=</span> Date<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>now</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span> <span class="token operator" data-v-2e29d265>+</span> sleepMs
	<span class="token keyword" data-v-2e29d265>while</span><span class="token punctuation" data-v-2e29d265>(</span>Date<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>now</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span> <span class="token operator" data-v-2e29d265>&lt;</span> timeToWakeUp<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token comment" data-v-2e29d265>// Do nothing</span>
	<span class="token punctuation" data-v-2e29d265>}</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of problem with synchronous programming.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>In this example, the long running operation was just a loop doing nothing for many iterations, but you can substitute it with any operation that takes long time to complete, for example to check if there's a human in the world named <code>Chipsope</code> (would in worst case require you to compare <code>Chipsope</code> with ~7 billion names, which would take a while).</p> <h3 id="problem-example-2-data-loading"><a href="#problem-example-2-data-loading" class="header-anchor">#</a> Problem Example 2: Data Loading</h3> <p>One problem with synchronous programming occurs when we want to carry out multiple tasks in parallel, and each task involves a lot of waiting, such as:</p> <ul><li>Waiting for the result of a query sent to the database</li> <li>Waiting for the response for an HTTP request we have sent</li> <li>Waiting for GPS coordinates from a GPS receiver</li> <li>Waiting for the computer to load the content of a file on the file system</li> <li>Etc.</li></ul> <p>If we use synchronous programming, then we start carrying out the first task, which involves some waiting for the result (for example from the database). When we get back the result, we finish carrying out the first task, and then we start carrying out the second task, which shortly makes us wait again for another result (perhaps loading the content from a file), and then when we finally get back the result for that, we finish the second task, and so on.</p> <p>The problem here is that we spend most of our time on waiting, instead of doing useful work. While we wait for the database result from task 1, we want to start carrying out task 2, and wait for the result for task 2 at the same time as we wait for the result from task 1, but we can't do that with synchronous programming, since we can only do one thing at a time in synchronous programming.</p> <p>An example of this is shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getAllHumans</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token comment" data-v-2e29d265>// Imagine db.getAllRows() would be a synchronous function, and it would</span>
	<span class="token comment" data-v-2e29d265>// take 1 second before it has received the humans from the database.</span>
	<span class="token keyword" data-v-2e29d265>const</span> allHumans <span class="token operator" data-v-2e29d265>=</span> db<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>getAllRows</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;humans&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token keyword" data-v-2e29d265>return</span> allHumans
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getAllPets</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token comment" data-v-2e29d265>// Imagine fileSystem.loadFile() would be a synchronous function, and</span>
	<span class="token comment" data-v-2e29d265>// it would take 1 second before it has loaded the pets from the file.</span>
	<span class="token keyword" data-v-2e29d265>const</span> allPets <span class="token operator" data-v-2e29d265>=</span> fileSystem<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>loadFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;pets.json&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token keyword" data-v-2e29d265>return</span> allPets
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token keyword" data-v-2e29d265>const</span> humans <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getAllHumans</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span> <span class="token comment" data-v-2e29d265>// This line would take 1.001 seconds to complete (1 second spent on waiting).</span>
<span class="token keyword" data-v-2e29d265>const</span> pets <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getAllPets</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span> <span class="token comment" data-v-2e29d265>// This line would take 1.001 seconds to complete (1 second spent on waiting).</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Another example of problem with synchronous programming. 
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>In <span class="whole" data-v-650a815e><span class="decrementFigureNumber" data-v-650a815e></span> <span class="figureNumber" data-v-650a815e></span> <span class="incrementFigureNumber" data-v-650a815e></span></span> above it takes ~2 seconds to load all data, but if humans and pets could be loaded at the same time, it would only take ~1 second. You don't like applications that takes a long time to load all the data at startup, right? So you probably don't want to use synchronous programming to do load data at startup.</p> <h2 id="what-is-asynchronous-programming"><a href="#what-is-asynchronous-programming" class="header-anchor">#</a> What is Asynchronous Programming?</h2> <p>So, asynchronous programming is when we start a long running operation, and it will run <em>in the background</em>. The rest of our code will run as usual while the long running operation runs in the background, until it completes. Then sometime in the future the long running operation will complete, and then the long running operation notifies our ordinary code what the result of the long running operation was, and our ordinary code can handle the result.</p> <div class="custom-block tip"><p class="custom-block-title">Long running operations that aren't waiting</p> <p>Here we say that long running operations usually involve a lot of waiting. Long running operations can instead/also do useful work, e.g. compute something really complex that takes a very long time to compute. These operations can still run in the background at the same time as our ordinary synchronous code thanks to threads and multiple cores (or in worst case time slicing of the CPU). But these are details we don't worry about in this lecture.</p></div> <p>The question is how the long running operation can tell our ordinary code when it's done doing it's work. That can be done in different ways, such as by using callback functions or promises.</p> <h2 id="asynchronous-programming-with-callback-functions"><a href="#asynchronous-programming-with-callback-functions" class="header-anchor">#</a> Asynchronous Programming with Callback Functions</h2> <p>One way in asynchronous programming to indicate what should happen after the long running operation has completed is to pass a <code>callback</code> function to the asynchronous function, and when the asynchronous function has completed its long running operation, it will call the <code>callback</code> function, and pass the result of the long running operation as an argument to the <code>callback</code> function. In the <code>callback</code> function we write the code that should run when the long running operation has completed.</p> <p>For example, if we have synchronous function in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Synchronous function that returns back the result.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>x<span class="token punctuation" data-v-2e29d265>,</span> y</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> theSum <span class="token operator" data-v-2e29d265>=</span> x <span class="token operator" data-v-2e29d265>+</span> y
	<span class="token keyword" data-v-2e29d265>return</span> theSum
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token keyword" data-v-2e29d265>const</span> sum <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>1</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>2</span><span class="token punctuation" data-v-2e29d265>)</span>
console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>sum<span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of a synchronous function.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>And would like to use this in an asynchronous way with a <code>callback</code> function, it would look as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Asynchronous function that calls the callback function with the result.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>x<span class="token punctuation" data-v-2e29d265>,</span> y<span class="token punctuation" data-v-2e29d265>,</span> callback</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>

	<span class="token comment" data-v-2e29d265>// This is the &quot;work&quot; the &quot;long running operation&quot; should do.</span>
	<span class="token keyword" data-v-2e29d265>const</span> theSum <span class="token operator" data-v-2e29d265>=</span> x <span class="token operator" data-v-2e29d265>+</span> y

	<span class="token comment" data-v-2e29d265>// When the result of the work has been computed, pass it to the callback function.</span>
	<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>theSum<span class="token punctuation" data-v-2e29d265>)</span>

<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// Call the asynchronous function, and pass along our callback function.</span>
<span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>1</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>2</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>sum</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>

	<span class="token comment" data-v-2e29d265>// When this function is called, the long running operation has completed.</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>sum<span class="token punctuation" data-v-2e29d265>)</span>

<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of an asynchronous function that will run synchronously.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>Even though <code>getSum()</code> above has a <code>callback</code> function as a parameter, everything will run synchronously, as you're used to. That's because we don't do any work that runs <em>in the background</em>. To make <code>getSum()</code> asynchronous, we need to tell it to do it's work in the background. You do that by calling an asynchronous built-in function, like:</p> <ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank" rel="noopener noreferrer">fetch<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (to send an HTTP request)</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout" target="_blank" rel="noopener noreferrer">setTimeout<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (to schedule a function to be called later)</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval" target="_blank" rel="noopener noreferrer">setInterval<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (to schedule a function to be called repeatedly with a given interval)</li> <li>Etc.</li></ul> <p>To really make <code>getSum()</code> asynchronous, we can call <code>setTimeout()</code> in it, as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Asynchronous function that calls the callback function with the result.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>x<span class="token punctuation" data-v-2e29d265>,</span> y<span class="token punctuation" data-v-2e29d265>,</span> callback</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>

	<span class="token comment" data-v-2e29d265>// Here we call an asynchronous function, making our own function asynchronous.</span>
	<span class="token comment" data-v-2e29d265>// In this case we schedule the function below to be called 1 second later.</span>
	<span class="token function" data-v-2e29d265>setTimeout</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		
		<span class="token keyword" data-v-2e29d265>const</span> theSum <span class="token operator" data-v-2e29d265>=</span> x <span class="token operator" data-v-2e29d265>+</span> y
		<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>theSum<span class="token punctuation" data-v-2e29d265>)</span>

	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>1000</span><span class="token punctuation" data-v-2e29d265>)</span>

	<span class="token comment" data-v-2e29d265>// Then we return back immediately, before we have computed the sum.</span>

<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// This will call our own asynchronous function,</span>
<span class="token comment" data-v-2e29d265>// which will call setTimeout(), and then return here immediately.</span>
<span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>1</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>2</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>sum</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>sum<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>

<span class="token comment" data-v-2e29d265>// This will call our own asynchronous function,</span>
<span class="token comment" data-v-2e29d265>// which will call setTimeout(), and then return here immediately.</span>
<span class="token function" data-v-2e29d265>getSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>3</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>sum</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>sum<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>

<span class="token comment" data-v-2e29d265>// This is the first value that will be logged.</span>
console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Hello!&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>

<span class="token comment" data-v-2e29d265>// 1 second later, the two callback functions we have passed to setTimeout()</span>
<span class="token comment" data-v-2e29d265>// will be called (one at a time), which in turn will compute their sums</span>
<span class="token comment" data-v-2e29d265>// and call the callback functions we passed to getSum(), in which we log</span>
<span class="token comment" data-v-2e29d265>// the computed sums (3 and 7).</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of an asynchronous function that will run asynchronously.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>So, to summarize:</p> <ol><li>To change a synchronous function so we can use it asynchronously, we need to add a <code>callback</code> parameter to it, and instead of returning back the computed value, we call the <code>callback</code> function and pass the <code>callback</code> function the computed value.</li> <li>To make a function with a <code>callback</code> function really run asynchronously, it needs to call another asynchronous function.</li></ol> <h3 id="error-handling"><a href="#error-handling" class="header-anchor">#</a> Error Handling</h3> <p>In synchronous programming, when you discover something is wrong, you usually throw an exception, which you later can catch, which you can see in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// The synchronous function that might throw an exception.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>dividend<span class="token punctuation" data-v-2e29d265>,</span> divisor</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>divisor <span class="token operator" data-v-2e29d265>==</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>throw</span> <span class="token string" data-v-2e29d265>&quot;Can't divide by 0.&quot;</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>return</span> dividend <span class="token operator" data-v-2e29d265>/</span> divisor
	<span class="token punctuation" data-v-2e29d265>}</span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// The main code that contains the error handling.</span>
<span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> quotient <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of error handling in synchronous programming using exceptions.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>If you try to do something similar in asynchronous programming with callback functions, it could look like as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// The asynchronous function that might throw an exception.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>dividend<span class="token punctuation" data-v-2e29d265>,</span> divisor<span class="token punctuation" data-v-2e29d265>,</span> callback</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token function" data-v-2e29d265>setTimeout</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>divisor <span class="token operator" data-v-2e29d265>==</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token keyword" data-v-2e29d265>throw</span> <span class="token string" data-v-2e29d265>&quot;Can't divide by 0.&quot;</span>
		<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>dividend <span class="token operator" data-v-2e29d265>/</span> divisor<span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>1000</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// The main code that needs to handle errors.</span>
<span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>quotient</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Trying to catch exceptions when calling an asynchronous function.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>This does unfortunately not work. The reason is simple: when you call <code>getQuotient()</code>, you are inside the try block, but <code>getQuotient()</code> returns back almost immediately, and you will leave the try/catch block. Then 1 second later, the <code>callback</code> you passed to <code>setTimeout()</code> will be called, and if you now throw the exception from inside that callback, you will throw it to the one who called the <code>callback</code> function, which will be the JavaScript runtime environment, so that's where the exception will be thrown to, and there of course no one is listening for your specific exceptions.</p> <p>The workaround to this problem is usually to pass two values to the <code>callback</code> function. The first value is the exception (aka &quot;the error&quot;). If everything go well and you don't get an error, you simply use <code>null</code> as the error. The second value is the result of the long running operation. In your <code>callback</code> function you simply check if the first argument is <code>null</code> or not with an if statement to figure out if you got an error, as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>dividend<span class="token punctuation" data-v-2e29d265>,</span> divisor<span class="token punctuation" data-v-2e29d265>,</span> callback</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token function" data-v-2e29d265>setTimeout</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>divisor <span class="token operator" data-v-2e29d265>==</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Can't divide by 0&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>null</span><span class="token punctuation" data-v-2e29d265>,</span> dividend <span class="token operator" data-v-2e29d265>/</span> divisor<span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>1000</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>error<span class="token punctuation" data-v-2e29d265>,</span> quotient</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
		console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of error handling in asynchronous programming with callback functions.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <h2 id="the-drawback-with-asynchronous-programming-with-callback-functions"><a href="#the-drawback-with-asynchronous-programming-with-callback-functions" class="header-anchor">#</a> The Drawback with Asynchronous Programming with Callback Functions</h2> <p>The drawback with asynchronous programming with <code>callback</code> functions is that it makes the code harder to read compared to synchronous programming, especially when you have many asynchronous functions you need to call in order, as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Imagine getUserById(), getPetsByOwnerName() and</span>
<span class="token comment" data-v-2e29d265>// storeInJsonFile() are all asynchronous functions.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>loadUserWithPetsAndStoreInFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>userId<span class="token punctuation" data-v-2e29d265>,</span> filename<span class="token punctuation" data-v-2e29d265>,</span> callback</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token function" data-v-2e29d265>getUserById</span><span class="token punctuation" data-v-2e29d265>(</span>userId<span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>userError<span class="token punctuation" data-v-2e29d265>,</span> user</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>userError<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>userError<span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>getPetsByOwnerName</span><span class="token punctuation" data-v-2e29d265>(</span>user<span class="token punctuation" data-v-2e29d265>.</span>name<span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>petsError<span class="token punctuation" data-v-2e29d265>,</span> pets</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
				<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>petsError<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
					<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>petsError<span class="token punctuation" data-v-2e29d265>)</span>
				<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
					<span class="token keyword" data-v-2e29d265>const</span> data <span class="token operator" data-v-2e29d265>=</span> <span class="token punctuation" data-v-2e29d265>{</span>
						pets
					<span class="token punctuation" data-v-2e29d265>}</span>
					<span class="token function" data-v-2e29d265>storeInJsonFile</span><span class="token punctuation" data-v-2e29d265>(</span>data<span class="token punctuation" data-v-2e29d265>,</span> filename<span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>storeError<span class="token punctuation" data-v-2e29d265>,</span> fileSize</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
						<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>storeError<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
							<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>storeError<span class="token punctuation" data-v-2e29d265>)</span>
						<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
							<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>null</span><span class="token punctuation" data-v-2e29d265>,</span> fileSize<span class="token punctuation" data-v-2e29d265>)</span>
						<span class="token punctuation" data-v-2e29d265>}</span>
					<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
				<span class="token punctuation" data-v-2e29d265>}</span>
			<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of sequential calls to asynchronous functions with callbacks.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>This is just a simple example, but you can already now see that the code has become quite hard to read due to all the indentation of the code, especially at the end of the code, with all closing brackets. Imagine we would need to call more asynchronous functions, or use more loops or conditional statements, etc. This messy type of code is known as <a href="http://callbackhell.com/" target="_blank" rel="noopener noreferrer">Callback Hell<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>If we compare the code above with synchronous code with the same functionality, it would look as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>loadUserWithPetsAndStoreInFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>userId<span class="token punctuation" data-v-2e29d265>,</span> filename</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>const</span> user <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getUserById</span><span class="token punctuation" data-v-2e29d265>(</span>userId<span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token keyword" data-v-2e29d265>const</span> pets <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getPetsByOwnerName</span><span class="token punctuation" data-v-2e29d265>(</span>user<span class="token punctuation" data-v-2e29d265>.</span>name<span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token keyword" data-v-2e29d265>const</span> data <span class="token operator" data-v-2e29d265>=</span> <span class="token punctuation" data-v-2e29d265>{</span>
			pets
		<span class="token punctuation" data-v-2e29d265>}</span>
		<span class="token keyword" data-v-2e29d265>const</span> fileSize <span class="token operator" data-v-2e29d265>=</span> fileSystem<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>storeInJsonFile</span><span class="token punctuation" data-v-2e29d265>(</span>data<span class="token punctuation" data-v-2e29d265>,</span> filename<span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token keyword" data-v-2e29d265>return</span> fileSize
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>throw</span> error <span class="token comment" data-v-2e29d265>// Could even skip try and catch since we throw the error again, but whatever.</span>
	<span class="token punctuation" data-v-2e29d265>}</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of sequential calls to synchronous functions.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>Clearly, the synchronous code is much easier to read. So this is the trade off: synchronous code is easier to read, but asynchronous code can run more efficient, since we don't waste time on waiting. Wouldn't it be great if there was a way to get the best of both worlds?</p> <h2 id="what-are-promises"><a href="#what-are-promises" class="header-anchor">#</a> What are Promises?</h2> <p><em>Promises</em> is an attempt to make asynchronous code more readable and to avoid callback hell (making the code look more like synchronous code), but that still runs asynchronously. Instead of passing a <code>callback</code> to an asynchronous function, the asynchronous function returns back a promise. The promise is an object that represent a long running operation that will be completed some time in the future.</p> <p>Initially, the promise will be in the <code>Pending</code> state, meaning that the long running operation is still running. When the long running operation complete (when the promise has been <em>resolved</em>), the promise will be in the <code>Fulfilled</code> state, and we can get the value the long running operations resulted in through the promise object. If something instead goes wrong with the long running operation (when the promise has been <em>rejected</em>), the promise will go into the <code>Rejected</code> state, and we can get the error through the promise object.</p> <p>When you have called an asynchronous function and received back a promise from it, you usually want to listen to when the promise goes from the <code>Pending</code> state to the <code>Fulfilled</code> state, or from the <code>Pending</code> state to the <code>Rejected</code> state. You do that by calling <code>.then()</code> on the promise and <code>.catch()</code> on the promise respectively.</p> <p>For example, if <code>getQuotient()</code> would be an asynchronous function with a <code>callback</code> function, you would use it as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>error<span class="token punctuation" data-v-2e29d265>,</span> quotient</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
		console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of an asynchronous function with a callback.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>If <code>getQuotient()</code> instead of having a <code>callback</code> function would return back a promise, you would use it as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>const</span> promise <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token comment" data-v-2e29d265>// When the line above has been executed, the promise will be in the Pending state.</span>

promise<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>then</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>quotient</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token comment" data-v-2e29d265>// When the promise has been resolved (enters the Fulfilled state),</span>
	<span class="token comment" data-v-2e29d265>// this function will be called.</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>

promise<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>error</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token comment" data-v-2e29d265>// When the promise has been rejected (enters the Rejected state),</span>
	<span class="token comment" data-v-2e29d265>// this function will be called.</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of an asynchronous function returning a promise.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>Since we still provide callback functions to <code>.then()</code> and <code>.catch()</code>, you might think this code will result in callback hell as well when we start calling multiple asynchronous functions returning back promises, but that is not the case, because promises are chainable. This is the hard part to understand with promises, so let's go through how it works in detail.</p> <p>The callback function you pass to <code>.then()</code> can:</p> <ol><li>Return back a new promise.</li> <li>Return back another value that automatically will be wrapped in a promise that will be immediately resolved.</li> <li>Not return back any value at all (i.e. <code>undefined</code>), in which case we can <strong>see it as</strong> the promise you called <code>.then()</code> on will be returned back.</li></ol> <p>Note that you can <em>see it as</em>* that the callback function you pass to <code>.then()</code> will always return back a promise. Promises are also implemented in a very clever way, so you can <strong>see it as</strong> the promise you return back from the callback function passed to <code>.then()</code> will also be returned from the call to <code>.then()</code>. All this and list item 3 above means that we can simplify the code we had earlier to the one shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>const</span> promise <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span>

promise<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>then</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>quotient</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token comment" data-v-2e29d265>// This function does not return a value, so we can see it</span>
	<span class="token comment" data-v-2e29d265>// as the promise itself will be returned.</span>

<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>error</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span> <span class="token comment" data-v-2e29d265>// So here we immediately call .catch() on the same promise.</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of an asynchronous function returning a promise.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>As you probably realise, we can even get rid of the <code>promise</code> variable and call <code>.then()</code> and <code>.catch()</code> on the promise directly, as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>then</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>quotient</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>error</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of an asynchronous function returning back a promise.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>This code will run asynchronously, and is looks really similar to what a synchronous version of the code would look like, which is shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span>, which is really promising.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> quotient <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of a synchronous function.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>The question is, how readable will the code be when we start using multiple promises? Will we get into a callback hell similar situation, as the one shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below where we use asynchronous functions with callbacks?</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Asynchronous version with callback functions.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>loadUserWithPetsAndStoreInFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>userId<span class="token punctuation" data-v-2e29d265>,</span> filename<span class="token punctuation" data-v-2e29d265>,</span> callback</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token function" data-v-2e29d265>getUserById</span><span class="token punctuation" data-v-2e29d265>(</span>userId<span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>userError<span class="token punctuation" data-v-2e29d265>,</span> user</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>userError<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>userError<span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>getPetsByOwnerName</span><span class="token punctuation" data-v-2e29d265>(</span>user<span class="token punctuation" data-v-2e29d265>.</span>name<span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>petsError<span class="token punctuation" data-v-2e29d265>,</span> pets</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
				<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>petsError<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
					<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>petsError<span class="token punctuation" data-v-2e29d265>)</span>
				<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
					<span class="token keyword" data-v-2e29d265>const</span> data <span class="token operator" data-v-2e29d265>=</span> <span class="token punctuation" data-v-2e29d265>{</span>
						pets
					<span class="token punctuation" data-v-2e29d265>}</span>
					fileSystem<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>storeInJsonFile</span><span class="token punctuation" data-v-2e29d265>(</span>data<span class="token punctuation" data-v-2e29d265>,</span> filename<span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>storeError<span class="token punctuation" data-v-2e29d265>,</span> fileSize</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
						<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>storeError<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
							<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span>storeError<span class="token punctuation" data-v-2e29d265>)</span>
						<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
							<span class="token function" data-v-2e29d265>callback</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>null</span><span class="token punctuation" data-v-2e29d265>,</span> fileSize<span class="token punctuation" data-v-2e29d265>)</span>
						<span class="token punctuation" data-v-2e29d265>}</span>
					<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
				<span class="token punctuation" data-v-2e29d265>}</span>
			<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// Sample usage of the function.</span>
<span class="token function" data-v-2e29d265>loadUserWithPetsAndStoreInFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>3</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token string" data-v-2e29d265>&quot;data.json&quot;</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>error</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
		console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Data stored in file &quot;</span><span class="token operator" data-v-2e29d265>+</span>fileSize<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot; bytes big!&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of callback hell.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>No, list item 1 above (our callback function passed to <code>.then()</code> can return back a new promise) makes sure that we don't get into a callback hell situation. If the asynchronous functions in the <span class="whole" data-v-650a815e><span class="decrementFigureNumber" data-v-650a815e></span> <span class="figureNumber" data-v-650a815e></span> <span class="incrementFigureNumber" data-v-650a815e></span></span> above would return back promises instead of using callback functions, the code would look as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Asynchronous version with promises.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>loadUserWithPetsAndStoreInFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>userId<span class="token punctuation" data-v-2e29d265>,</span> filename</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>return</span> <span class="token function" data-v-2e29d265>getUserById</span><span class="token punctuation" data-v-2e29d265>(</span>userId<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>then</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>user</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>return</span> <span class="token function" data-v-2e29d265>getPetsByOwnerName</span><span class="token punctuation" data-v-2e29d265>(</span>user<span class="token punctuation" data-v-2e29d265>.</span>name<span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>then</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>pets</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>const</span> data <span class="token operator" data-v-2e29d265>=</span> <span class="token punctuation" data-v-2e29d265>{</span>
			pets
		<span class="token punctuation" data-v-2e29d265>}</span>
		<span class="token keyword" data-v-2e29d265>return</span> fileSystem<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>storeInJsonFile</span><span class="token punctuation" data-v-2e29d265>(</span>data<span class="token punctuation" data-v-2e29d265>,</span> filename<span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// Sample usage of the function.</span>
<span class="token function" data-v-2e29d265>loadUserWithPetsAndStoreInFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>3</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token string" data-v-2e29d265>&quot;data.json&quot;</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>then</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>fileSize</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Data stored in file &quot;</span><span class="token operator" data-v-2e29d265>+</span>fileSize<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot; bytes big!&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>error</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of sequential calls to asynchronous functions returning back promises.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>An importing thing to know when using chained promises like we do here is that if one of the promises in the chain is rejected, the next promises in the chain will never be resolved, and the error will be passed to the callback functions passed to <code>.catch()</code> no matter which promise that was rejected. So in <span class="whole" data-v-650a815e><span class="decrementFigureNumber" data-v-650a815e></span> <span class="figureNumber" data-v-650a815e></span> <span class="incrementFigureNumber" data-v-650a815e></span></span> above, even if it looks like we only call <code>.catch()</code> on the last promise in the chain, the callback function we pass to it will be called if any promise in the chain will be rejected.</p> <p>This way of writing asynchronous code (with promises) is really similar to synchronous code, as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Synchronous version.</span>
<span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>loadUserWithPetsAndStoreInFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>userId<span class="token punctuation" data-v-2e29d265>,</span> filename</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> user <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getUserById</span><span class="token punctuation" data-v-2e29d265>(</span>userId<span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token keyword" data-v-2e29d265>const</span> pets <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>getPetsByOwnerName</span><span class="token punctuation" data-v-2e29d265>(</span>user<span class="token punctuation" data-v-2e29d265>.</span>name<span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token keyword" data-v-2e29d265>const</span> data <span class="token operator" data-v-2e29d265>=</span> <span class="token punctuation" data-v-2e29d265>{</span>
		pets
	<span class="token punctuation" data-v-2e29d265>}</span>
	<span class="token keyword" data-v-2e29d265>const</span> fileSize <span class="token operator" data-v-2e29d265>=</span> fileSystem<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>storeInJsonFile</span><span class="token punctuation" data-v-2e29d265>(</span>data<span class="token punctuation" data-v-2e29d265>,</span> filename<span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token keyword" data-v-2e29d265>return</span> fileSize
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token comment" data-v-2e29d265>// Sample usage of the function.</span>
<span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> fileSize <span class="token operator" data-v-2e29d265>=</span> <span class="token function" data-v-2e29d265>loadUserWithPetsAndStoreInFile</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>3</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token string" data-v-2e29d265>&quot;data.json&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Data stored in file &quot;</span><span class="token operator" data-v-2e29d265>+</span>fileSize<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot; bytes big!&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;error&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of sequential calls to synchronous functions.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>The only downside with promises is that we need to pass callback functions to <code>.then()</code> and <code>.catch()</code>, which makes our code a little bit more indented and a little bit harder to read than the synchronous code, but that we can solve with <code>async</code> and <code>await</code>.</p> <h2 id="async-and-await"><a href="#async-and-await" class="header-anchor">#</a> Async and Await</h2> <p>The keywords <code>async</code> and <code>await</code> can make our asynchronous code with promises even more readable. The <code>await</code> operator is the real hero of these two. Instead of calling <code>.then()</code> or <code>.catch()</code> on a promise, we can wait for the promise to be resolved or rejected with the <code>await</code> operator. When the promise resolve, the <code>await</code> operator will yield the value the promise resolved to, and when the promise is rejected the <code>await</code> operator will throw the error as an exception.</p> <p>So, without <code>async</code> and <code>await</code>, we can call an asynchronous function returning a promise as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Asynchronous version with promises.</span>
<span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>then</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>quotient</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>error</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of an asynchronous function returning back a promise.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>If we would use the <code>await</code> operator, it would instead look as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Asynchronous version with promises and await.</span>
<span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> quotient <span class="token operator" data-v-2e29d265>=</span> <span class="token keyword" data-v-2e29d265>await</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Sample usage of an awaiting an promise returned back from a function.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>This code is just as readable as synchronous code, the only different is that whenever we call a function that returns a promise, we must remember to use the <code>await</code> operator to wait for the promise to be resolved or rejected.</p> <p>Whenever you use the <code>await</code> operator in a function, you must mark that function with the <code>async</code> keyword. A function marked with the <code>async</code> keyword always returns back a promise that will resolve to the value you <code>return</code> back from the function. An example of that is shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token comment" data-v-2e29d265>// Asynchronous version with promises and async/await.</span>
<span class="token keyword" data-v-2e29d265>async</span> <span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getTheSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> quotient1 <span class="token operator" data-v-2e29d265>=</span> <span class="token keyword" data-v-2e29d265>await</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>2</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token keyword" data-v-2e29d265>const</span> quotient2 <span class="token operator" data-v-2e29d265>=</span> <span class="token keyword" data-v-2e29d265>await</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>5</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>3</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token keyword" data-v-2e29d265>return</span> quotient1 <span class="token operator" data-v-2e29d265>+</span> quotient12
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token keyword" data-v-2e29d265>async</span> <span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>logTheSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>const</span> theSum <span class="token operator" data-v-2e29d265>=</span> <span class="token keyword" data-v-2e29d265>await</span> <span class="token function" data-v-2e29d265>getTheSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Couldn't log the sum because division by 0.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token function" data-v-2e29d265>logTheSum</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span> <span class="token comment" data-v-2e29d265>// Use the await operator here if you want the sum to be logged before Hello!</span>
<span class="token comment" data-v-2e29d265>// As it is now (without the await operator), Hello! will be logged first.</span>

console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Hello!&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Example of async functions.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <h2 id="how-to-create-promises"><a href="#how-to-create-promises" class="header-anchor">#</a> How to Create Promises</h2> <p>Often, promises are created automatically for you when you call one of the built-in function in the JavaScript runtime environment that run asynchronously and returns a promise, such as:</p> <ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank" rel="noopener noreferrer">fetch()<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>It's also possible to create your own promises using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener noreferrer">the Promise constructor<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. You need to pass a callback function to the Promise constructor. That callback function will be invoked immediately by the constructor, and in that function you should write the code for the long running operation. The constructor will also pass you two callback functions, one called <code>resolve()</code>, and one called <code>reject()</code>.</p> <p>When your long running operation has completed, you should call <code>resolve()</code> and pass it the value the long running operation resulted in. If something goes wrong you should instead call <code>reject()</code>, and pass it the error. An example of this is shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>const</span> myPromise <span class="token operator" data-v-2e29d265>=</span> <span class="token keyword" data-v-2e29d265>new</span> <span class="token class-name" data-v-2e29d265>Promise</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>resolve<span class="token punctuation" data-v-2e29d265>,</span> reject</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token comment" data-v-2e29d265>// The work the promise should do should be written here.</span>
	<span class="token comment" data-v-2e29d265>// If all goes well, call resolve(), and pass it the computed value.</span>
	<span class="token comment" data-v-2e29d265>// If something goes wrong, call reject(), and pass it the error.</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
</code></pre></div> <figcaption data-v-2e29d265>
		Template for creating your own promise.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>To implement <code>getQuotient()</code> as an asynchronous function using promises, it would look as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>dividend<span class="token punctuation" data-v-2e29d265>,</span> divisor</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>return</span> <span class="token keyword" data-v-2e29d265>new</span> <span class="token class-name" data-v-2e29d265>Promise</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>resolve<span class="token punctuation" data-v-2e29d265>,</span> reject</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>divisor <span class="token operator" data-v-2e29d265>==</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>reject</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Can't divide by 0&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token function" data-v-2e29d265>resolve</span><span class="token punctuation" data-v-2e29d265>(</span>dividend <span class="token operator" data-v-2e29d265>/</span> divisor<span class="token punctuation" data-v-2e29d265>)</span>
		<span class="token punctuation" data-v-2e29d265>}</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> quotient <span class="token operator" data-v-2e29d265>=</span> <span class="token keyword" data-v-2e29d265>await</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		A function returning a custom promise.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>You can use the promise above in the same way as any other promise, but since it doesn't contain any call to an asynchronous function (that runs in the background), it will run synchronous. To make it asynchronous, we could for example use <code>setTimeout()</code> to delay the computations, as shown in <span class="whole" data-v-650a815e><!----> <span class="figureNumber" data-v-650a815e></span> <!----></span> below.</p> <figure data-v-2e29d265><div class="language-js extra-class" data-v-2e29d265><pre class="language-js" data-v-2e29d265><code data-v-2e29d265><span class="token keyword" data-v-2e29d265>function</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>dividend<span class="token punctuation" data-v-2e29d265>,</span> divisor</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>return</span> <span class="token keyword" data-v-2e29d265>new</span> <span class="token class-name" data-v-2e29d265>Promise</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token parameter" data-v-2e29d265>resolve<span class="token punctuation" data-v-2e29d265>,</span> reject</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
		<span class="token function" data-v-2e29d265>setTimeout</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token keyword" data-v-2e29d265>function</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
			<span class="token keyword" data-v-2e29d265>if</span><span class="token punctuation" data-v-2e29d265>(</span>divisor <span class="token operator" data-v-2e29d265>==</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
				<span class="token function" data-v-2e29d265>reject</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;Can't divide by 0&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
			<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>else</span><span class="token punctuation" data-v-2e29d265>{</span>
				<span class="token function" data-v-2e29d265>resolve</span><span class="token punctuation" data-v-2e29d265>(</span>dividend <span class="token operator" data-v-2e29d265>/</span> divisor<span class="token punctuation" data-v-2e29d265>)</span>
			<span class="token punctuation" data-v-2e29d265>}</span>
		<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>1000</span><span class="token punctuation" data-v-2e29d265>)</span>
	<span class="token punctuation" data-v-2e29d265>}</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>

<span class="token keyword" data-v-2e29d265>try</span><span class="token punctuation" data-v-2e29d265>{</span>
	<span class="token keyword" data-v-2e29d265>const</span> quotient <span class="token operator" data-v-2e29d265>=</span> <span class="token keyword" data-v-2e29d265>await</span> <span class="token function" data-v-2e29d265>getQuotient</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token number" data-v-2e29d265>4</span><span class="token punctuation" data-v-2e29d265>,</span> <span class="token number" data-v-2e29d265>0</span><span class="token punctuation" data-v-2e29d265>)</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span><span class="token string" data-v-2e29d265>&quot;The quotient is &quot;</span><span class="token operator" data-v-2e29d265>+</span>quotient<span class="token operator" data-v-2e29d265>+</span><span class="token string" data-v-2e29d265>&quot;.&quot;</span><span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span><span class="token keyword" data-v-2e29d265>catch</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span><span class="token punctuation" data-v-2e29d265>{</span>
	console<span class="token punctuation" data-v-2e29d265>.</span><span class="token function" data-v-2e29d265>log</span><span class="token punctuation" data-v-2e29d265>(</span>error<span class="token punctuation" data-v-2e29d265>)</span>
<span class="token punctuation" data-v-2e29d265>}</span>
</code></pre></div> <figcaption data-v-2e29d265>
		A function returning a custom promise that runs (waits) in the background.
	</figcaption> <span class="incrementFigureNumber" data-v-2e29d265></span></figure> <p>Note that when you implement functions that makes use of promises from scratch, the implementation can have a few symptoms of callback hell, as <code>getQuotient()</code> above. The real benefit with promises is that the code is really easy to read when you call functions returning promises, as in the try/catch block above.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/PeppeL-G/course-material/edit/master/src/lectures/asynchronous-programming-in-js/README.md" target="_blank" rel="noopener noreferrer">Improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2021-01-25 10:11:02</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/course-material/assets/js/app.222f1d4d.js" defer></script><script src="/course-material/assets/js/2.873e2bc6.js" defer></script><script src="/course-material/assets/js/8.9228a913.js" defer></script><script src="/course-material/assets/js/10.1cd6f68e.js" defer></script><script src="/course-material/assets/js/13.b01bcf64.js" defer></script><script src="/course-material/assets/js/5.ea5235af.js" defer></script><script src="/course-material/assets/js/7.b6e5d6eb.js" defer></script>
  </body>
</html>
